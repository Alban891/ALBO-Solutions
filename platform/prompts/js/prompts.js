/* ========================================== */
/* ALBO PROMPTS - 3-LEVEL HIERARCHY */
/* Multi-Role with MECE Theme Structure */
/* ========================================== */

class PromptsEngine {
    constructor() {
        this.taskQueue = [];
        this.allPrompts = this.getAllPrompts();
        this.currentView = 'roles';  // 'roles' | 'themes' | 'prompts'
        this.currentMode = 'templates';
        this.currentRole = null;
        this.currentTheme = null;
        this.currentPrompt = null;
        this.userAnswers = {};
        this.searchQuery = '';
        
        // MECE Theme Mapping
        this.themeMapping = this.getThemeMapping();
        
        console.log('üí° Prompts Engine initialized (3-Level Hierarchy)');
        console.log(`üìö Loaded ${this.allPrompts.length} prompts across ${this.getRoleCount()} roles`);
    }

    getThemeMapping() {
        return {
    "Controller": {
        "icon": "üìä",
        "themes": [
            {"id": "kostenrechnung", "name": "üí∞ Kostenrechnung", "keywords": ["Kostenartenrechnung", "Materialkostenanalyse", "Personalkostenanalyse", "Kostenstellenrechnung", "Gemeinkosten", "Kostenstellenstruktur", "Ineffiziente Kostenstellen", "Kostentr√§gerrechnung", "Einstufige Deckungsbeitragsrechnung", "Mehrstufige Deckungsbeitragsrechnung", "Deckungsbeitragsanalyse", "Prozesskostenrechnung", "Activity-Based"]},
            {"id": "kalkulation", "name": "üìê Kalkulation", "keywords": ["Zuschlagskalkulation", "Angebotspreis", "Maschinenstundensatz", "Verrechnung", "Herstellkosten je Einheit", "Variantenprodukte", "Komplexit√§t sauber", "Vertriebs-/Preiskalkulation", "Zielmarge", "Deckungsbeitragskalkulation", "Produktlinien", "Nachkalkulation", "Plankalkulation", "Abweichungen", "Kalkulation f√ºr Projektgesch√§ft", "Zeit, Material, Overhead", "Kostent√§gerzeitrechnung", "F√ºr komplexe Auftr√§ge", "Kalkulationssimulation", "Preis-/Kosten-/Mengen√§nderungen"]},
            {"id": "budgetierung", "name": "üìà Budgetierung & Forecasting", "keywords": ["Integrierte Budgetierung", "Abteilungs√ºbergreifend", "Szenariobasierte Budgetierung", "Marketing-Budgetierung", "ROI", "Budgetierung von Fixkosten und variablen", "Kurzfrist-Forecasting", "bis 6 Monate", "Rolling Forecast", "Long-Term Forecast", "Treiberbasierte Planung", "Echtzeit-Monitoring von Budgetabweichungen", "Ursachenanalyse von Budgetabweichungen", "Agile Forecasting", "Planning"]},
            {"id": "investition", "name": "üíº Investitionsplanung", "keywords": ["Kostenvergleichsrechnung", "Gewinnvergleichsrechnung", "Rentabilit√§tsvergleichsrechnung", "Amortisationsrechnung", "Kapitalwertmethode", "Interne Zinsfu√ü-Methode", "Annuit√§tenmethode", "Dynamische Amortisationsrechnung", "Optimale Nutzungsdauer", "Ersatzzeitpunkt", "Investitionsplanung inkl. Risiko-", "Sensitivit√§tsanalyse"]},
            {"id": "kennzahlen", "name": "üìä Kennzahlensysteme", "keywords": ["Analyse der Verm√∂gensstruktur", "Kapitalstruktur-Analyse", "Liquidit√§tskennzahlen", "Cash Management Optimierung", "Rentabilit√§tskennzahlen", "Performance bewerten", "steuern", "Cashflow-Kennzahlen", "Innenfinanzierungskraft", "Kosten- und Ergebnisstruktur", "Material-, Personal-", "Fixkostenanalyse", "Case - Vertriebs-", "Marketingkostenanalyse", "Kennzahlensysteme", "DuPont", "Value-based KPIs", "Balanced Scorecard", "Fr√ºhwarn-", "Krisenkennzahlen", "Branchen-", "Benchmark-Kennzahlen", "KPI-Storytelling", "Management-Kommunikation"]},
            {"id": "berichterstattung", "name": "üìÑ Finanzberichterstattung", "keywords": ["Monats-, Quartals-", "Jahresabschl√ºsse professionell", "Abweichungsanalyse mit Handlungsempfehlung", "Konzernreporting", "Konsolidierung", "Forecasting", "Rolling Forecasts", "Kennzahlen-Reporting", "KPIs", "Financial Ratios", "Management Reporting", "Visualisierung", "Storytelling im Reporting", "Sonderanalysen", "Ad-hoc-Reporting", "Berichtskommentierung", "Ableitung von Handlungsempfehlungen", "Automatisierung und KI im Reporting"]},
            {"id": "konzern", "name": "üè¢ Konzerncontrolling", "keywords": ["Konzernreporting", "GuV, Bilanz, Cashflow", "KPI-Analyse", "Intercompany-Abstimmung", "Konsolidierungsvorbereitung", "Kapitalkonsolidierung", "Analyse", "Darstellung", "Aufwands-", "Ertragskonsolidierung", "Zwischenergebniseliminierung", "Konzern-Cashflow-Rechnung", "automatisiert", "interpretierbar", "Segment-", "Spartenreporting", "Benchmark", "Handlungsempfehlungen", "Konzern-Kennzahlenanalyse", "Konzern-Prognose", "Forecast", "Szenario-Logik", "Kommentierung von Konzernabschl√ºssen", "KPI-Storytelling auf Konzernebene"]},
            {"id": "projekt", "name": "üéØ Projektcontrolling", "keywords": ["Projektkostenplanung", "Bottom-up", "Top-down", "Projektstruktur-", "Meilensteinplanung", "Projektbudget-Controlling", "Mittelabruf", "Projektstatusbericht", "Ampellogik", "Ma√ünahmen", "Projekt-Deckungsbeitragsrechnung", "Forecast", "Szenarien im Projektverlauf", "Projektrisiken identifizieren", "managen", "Projektkommunikation", "Entscheidungsvorlagen", "Projektabschlussanalyse", "Abweichungen, Learnings", "Erfolgsfaktoren", "Erfolgsfaktoren-Profil", "Benchmarking", "Was gute Projekte ausmacht"]},
            {"id": "businesscase", "name": "üí° Business Case Controlling", "keywords": ["Klassischer Business Case f√ºr Produktinvestitionen", "Ganzheitlicher Investitions-Business-Case", "produktionsnahe Industrien", "Business Case f√ºr Software", "Digitalisierung", "Effizienz-", "Skalierungslogik", "Make-or-Buy Business Case", "wirtschaftlichem und strategischem Vergleich", "Business Case in Krisensituationen", "Turnaround, Standortschlie√üung, Rettungsszenarien", "Szenario-basierter Business Case", "Base / Best / Stress", "ESG-", "Nachhaltigkeits-Business Case", "Impact-Logik", "nicht-monet√§re Bewertung", "Kunden-/Marktbasierter Business Case", "Neukundengewinnung, CLV, Vertriebspotenzial", "Interner Business Case f√ºr Transformation", "Change", "Prozesse, Kultur, Organisation", "Branchenvergleich: Industrie vs. Software", "Business Case Logik, KPIs, Steuerung", "Business Case One-Pager", "Management Summary f√ºr Investitionsentscheidung"]},
            {"id": "digital", "name": "üöÄ Digitale Gesch√§ftsmodelle", "keywords": ["KPI-Entwicklung f√ºr digitale Gesch√§ftsmodelle", "Planung", "Forecasting f√ºr digitale Gesch√§ftsmodelle", "Break-Even-Analyse", "Skalierung digitaler Gesch√§ftsmodelle", "Performance-Measurement digitaler Gesch√§ftsmodelle", "Value", "Customer Metrics", "Szenario-Analyse", "Risikobewertung f√ºr digitale Gesch√§ftsmodelle", "Business Case", "Investitionsrechnung f√ºr digitale Gesch√§ftsmodelle", "KPI-Dashboard", "Reporting f√ºr digitale Gesch√§ftsmodelle", "Storytelling f√ºr digitale Gesch√§ftsmodelle", "Prozesskostenrechnung", "Operating Leverage im Controlling digitaler Gesch√§ftsmodelle"]},
            {"id": "startup", "name": "üå± Controlling f√ºr Start-ups", "keywords": ["Wie behalte ich als Gr√ºnder den √úberblick", "Einnahmen", "Ausgaben verstehen", "Mini-GuV f√ºr Start-ups", "Fixkosten erkennen", "reduzieren", "Wo geht mein Geld hin", "Break-even berechnen", "Wann ist mein Unternehmen profitabel", "Finanzplan f√ºrs 1. Jahr", "F√ºr Banken, F√∂rderstellen", "dich selbst", "Umsatzplanung mit wenig Daten", "Szenarien f√ºr unsichere Startphasen", "Einfache Kennzahlen", "Fr√ºhwarnsystem", "Die 3 wichtigsten Zahlen f√ºr dein Business", "Reporting f√ºr Investoren", "F√∂rderstellen", "Monatsbericht in einfach", "Liquidit√§tsplanung ohne Finanzprofi", "90-Tage-Vorschau einfach gemacht", "Vorbereitung auf das erste Mitarbeitergespr√§ch", "Personalkosten", "Planung verstehen"]},
            {"id": "kalkulation_gruender", "name": "üßÆ Kalkulation f√ºr Gr√ºnder", "keywords": ["Einfach kalkulieren", "Was soll ich f√ºr diesen Auftrag verlangen", "Kostenvoranschlag erstellen", "Einfach, verst√§ndlich", "professionell", "Stundensatz richtig berechnen", "Was kostet 1 Stunde wirklich", "Angebotskalkulation mit Material", "Zeit", "F√ºr Handwerk, Dienstleistung, Bau", "Was bleibt √ºbrig", "Deinen Gewinn je Auftrag berechnen", "Preisidee vs. echte Kosten", "Ich dachte, ich verdiene mehr", "Rabatte", "Nachl√§sse richtig kalkulieren", "Was kostet dich ein 10 % Rabatt wirklich", "Preiserh√∂hung erkl√§ren", "begr√ºnden", "F√ºr Stammkunden oder Preisverhandlungen", "Neue Leistungen kalkulieren", "Was kann ich f√ºr mein neues Produkt/Angebot verlangen", "Verkalkuliert", "So berechnest du unerwartete Zusatzkosten richtig", "Auftrag abgebrochen", "Was bleibt dir", "Kannst du geltend machen"]}
        ]
    },
    "Treasury": {
        "icon": "üè¶",
        "themes": [
            {"id": "cash_liquiditaet", "name": "üíµ Cash- & Liquidit√§tsplanung", "keywords": ["Tagesbasierte Liquidit√§tsvorschau", "13-Wochen Rolling Forecast", "Liquidit√§tsplanung auf Wochenbasis", "Szenarioanalyse - Normal, Stress, Worst Case", "Liquidit√§tsplanung", "Liquidit√§tskennzahlen-Dashboard", "Steuerung durch KPIs", "Kapitaldienstf√§higkeitspr√ºfung", "Liquidit√§tsbasierte Analyse", "R√ºckzahlungsf√§higkeit", "Liquidit√§tsauswirkungen einer Investition simulieren", "Kapitalbindung richtig absch√§tzen", "Fr√ºhwarnindikator f√ºr Liquidit√§tsengp√§sse", "automatisiert, flexibel, pr√§ventiv", "Analyse von Zahlungszielen", "Liquidit√§t durch Working Capital Steuerung verbessern", "FX-basierte Liquidit√§tsplanung", "Liquidit√§tsreporting f√ºr Bankgespr√§ch", "bankf√§hig, belastbar, vorausschauend"]},
            {"id": "finanzplanung_budgetierung", "name": "üìà Finanzplanung & Budgetierung", "keywords": ["Treasury-Budget f√ºr das kommende Gesch√§ftsjahr", "Integration der Liquidit√§tsplanung in den Gesamtfinanzplan", "Simulation des Free Cashflows nach Investitionen und Finanzierung", "Szenariobasierte Finanzplanung", "Absicherung gegen Markt- und Planungsunsicherheiten", "Abgleich Forecast vs. Budget", "Abweichungsanalyse und Ursachenbewertung", "Planung der Zinsaufwendungen bei variablen Kreditlinien", "Finanzplanung unter Ber√ºcksichtigung saisonaler Schwankungen", "Working Capital Effekte in die Finanzplanung integrieren", "Treasury-Kostenstellenbudgetierung inkl. TMS und Banken", "Planung der Treasury-KPIs im Jahreszielsystem"]},
            {"id": "finanzierung_kapitalbeschaffung", "name": "üí∞ Finanzierung & Kapitalbeschaffung", "keywords": ["Strukturierung eines optimalen Finanzierungsmixes", "Kapazit√§tsanalyse bestehender Kreditlinien", "Simulationsmodell f√ºr Covenant-Entwicklung", "Liquidit√§tswirksamkeit von Finanzierungsvorhaben simulieren", "Bankf√§higes Finanzierungskonzept erstellen", "Vergleich Kredit- vs. Leasing-Finanzierung", "Vorbereitung auf Refinanzierungsgespr√§che", "Einsatz von F√∂rderkrediten pr√ºfen und strukturieren", "Ermittlung des Fremdkapitalbedarfs aus Investitionsplanung", "Finanzierungsstrategie im Gesch√§ftsmodell verankern"]},
            {"id": "banking_zahlungsverkehr", "name": "üè¶ Banking & Zahlungsverkehr", "keywords": ["Optimierung der Kontostruktur im Unternehmen", "Benchmark der Bankgeb√ºhren und Verhandlungsstrategie", "Entwicklung eines zentralen Zahlungsverkehrskonzepts", "Cash Pooling", "Konzeption und Umsetzungsplan", "Einf√ºhrung einer globalen Zahlungsrichtlinie", "Analyse der Bankbeziehungen und Bankpartnerstrategie", "Instant Payment Integration im Unternehmen", "SEPA- und SWIFT-Konformit√§tscheck f√ºr Zahlungsprozesse", "Zahlungsverkehrssicherheit", "Fraud-Risiken erkennen und minimieren", "Einf√ºhrung eines zentralen Payment Hubs"]},
            {"id": "hedging_absicherung", "name": "üõ°Ô∏è Hedging & Absicherungsstrategien", "keywords": ["Entwicklung einer Hedging-Strategie f√ºr W√§hrungsrisiken", "Simulation der Hedging-Wirkung bei FX-Schwankungen", "Bewertung bestehender Zinsderivate auf Effektivit√§t", "Entscheidungsmatrix f√ºr den Einsatz von FX-Hedging-Instrumenten", "Cashflow-Hedge Accounting vorbereiten", "Rohstoffpreisabsicherung systematisch aufbauen", "Sensitivit√§tsanalyse f√ºr Zinssicherungsbedarf", "Bewertung der Hedge-Quote in FX-Exposures", "Optimale Nutzungsdauer", "Ersatzzeitpunkt", "Aufbau eines internen Hedging-Reportings mit Fr√ºhwarnsystem", "Use Case: Donald Trump und die Strafz√∂lle"]},
            {"id": "compliance_regulatory", "name": "‚öñÔ∏è Compliance & Regulatorische ...", "keywords": ["√úberpr√ºfung der Einhaltung von EMIR- und MiFIR-Pflichten", "Bewertung von Sanktionsrisiken bei internationalen Zahlungspartnern", "Einf√ºhrung eines internen IKS f√ºr Treasury-Prozesse", "Check regulatorischer Anforderungen bei TMS-Auswahl und -Einf√ºhrung", "Meldepflichten bei grenz√ºberschreitenden Finanztransaktionen", "AWV, Z4 etc.", "Bewertung von Treasury-Prozessen auf BAIT-/MaRisk-Konformit√§t", "Entwicklung eines KYC-Checks f√ºr neue Banken oder Zahlungspartner", "Erstellung eines Compliance-Reports f√ºr das Treasury", "Aufbau eines Notfallplans bei regulatorischen Verst√∂√üen oder Datenverlust", "Regulatorische Vorpr√ºfung bei internationalen Cash Pooling-Strukturen"]},
            {"id": "treasury_strategie", "name": "üéØ Treasury Strategie & Governance", "keywords": ["Entwicklung einer konzernweiten Treasury Governance", "Aufbau einer Treasury-Vision", "strategischen Zielbildes", "Festlegung eines Rollen- und Verantwortungsmodells im Treasury", "Strategische Bewertung zentraler vs. dezentraler Treasury-Organisation", "Entwicklung einer Treasury Scorecard mit KPIs und Zielwerten", "Entwicklung eines Treasury Operating Models", "Prozesse, Systeme, Struktur", "Benchmark des Treasury-Reifegrads mit Branchenvergleich", "Entwicklung einer Strategie zur Treasury-Digitalisierung", "Ableitung einer Personalstrategie f√ºr die Treasury-Funktion", "Bewertung der Positionierung des Treasury gegen√ºber CFO, Business", "Banken"]},
            {"id": "finanzierung_kapitalstruktur", "name": "üíº Finanzierung & Kapitalstruktur", "keywords": ["Optimierung des Finanzierungsmix", "kurz-/langfristig", "Vorbereitung auf Kreditgespr√§che und Bankenauswahl", "Liquidit√§tsbasierte Kreditlinienplanung", "Projektstatusbericht", "KPIs, Ampellogik", "Ma√ünahmen", "Entwicklung einer Covenant-Strategie zur Risikosteuerung", "Aufbau einer Kapitalbedarfsplanung f√ºr Wachstums- und Krisenszenarien", "Strategische Planung der Eigen-/Fremdkapitalquote", "Kapitalmarktf√§higkeit und Rating-Vorbereitung", "Finanzierung internationaler Gesellschaften", "Planung und Durchf√ºhrung von Refinanzierungen"]},
            {"id": "esg_sustainable", "name": "üå± ESG & Sustainable Finance im Treasury", "keywords": ["Entwicklung einer ESG-Finanzierungsstrategie im Treasury", "ESG-Kriterien in Kreditvertr√§ge integrieren und steuern", "Green Bond oder Schuldschein strukturiert vorbereiten", "ESG-Scoring im Treasury einf√ºhren und operationalisieren", "Nachhaltigkeitskriterien in Cash- und Bankmanagement verankern", "CSRD-Reporting vorbereiten", "Beitrag des Treasury zur ESG-Berichterstattung", "Entwicklung eines ESG-Treasury-Leitbilds", "Abgleich von ESG-Anforderungen in Kreditvertr√§gen vs. Nachhaltigkeitsstrategie", "Entwicklung eines ESG-Bankenrankings", "Treasury-gest√ºtzte CO‚ÇÇ-Reduktionsstrategie √ºber Finanzinstrumente"]},
            {"id": "treasury_operating", "name": "üîß Treasury Operating Model & ...", "keywords": ["Entwicklung einer Innovationsstrategie f√ºr das Treasury", "Planung", "Forecasting f√ºr digitale Gesch√§ftsmodelle", "Strategische Planung einer API-f√§higen Treasury-Systemarchitektur", "Aufbau einer Treasury-KI-Strategie zur Entscheidungsunterst√ºtzung", "Cyber- und IT-Sicherheitsstrategie f√ºr Treasury-Systeme", "Erstellung einer digitalen Treasury-Roadmap bis 2030", "Einf√ºhrung eines Treasury-KPI- und Benchmarksystems", "Aufbau eines Skill- und Rollenmodells f√ºr das Treasury der Zukunft", "Einf√ºhrung eines Process-Mining-Ansatzes zur Analyse von Treasury-Prozessen", "Positionierung des Treasurys als Innovationstreiber im Unternehmen"]}
        ]
    },
    "CFO": {
        "icon": "üìà",
        "themes": [
            {"id": "strategie_vision", "name": "üéØ Strategie & Vision", "keywords": ["Finanzielle Vision 2030 formulieren", "verankern", "Zukunftsanalyse", "3 Szenarien f√ºr Umsatz, Risiko, Kapitalbedarf", "Werttreiber-Modell des Unternehmens entwickeln", "Strategische Fr√ºhindikatoren", "CFO-Kennzahlensystem", "CFO-Radar: Strategiegespr√§che intelligent vorbereiten", "Portfolio-Readiness: Gesch√§ftsfelder strategisch bewerten", "CFO-Strategiepapier: 3-Jahres-Roadmap f√ºr Finance", "Wachstumsarchitektur mit Finanzlogik unterlegen", "Strategie-Kompetenzmodell f√ºr das CFO-Team aufbauen", "CFO-Zielbild", "F√ºhrungsrolle der Zukunft"]},
            {"id": "global_strategy", "name": "üåç Global Strategy", "keywords": ["L√§nderscoring-Modell zur internationalen Expansion", "Break-even-Analyse f√ºr internationale Rollouts", "Rollout-Reifegradmodell f√ºr internationale M√§rkte", "Go-to-Market-Modell f√ºr internationale Expansion", "KPI-Mastermodell f√ºr internationale Expansion", "Expansions-Risikomodell f√ºr internationale M√§rkte", "Insight Asia 2025 - Geopolitisch-strategisch", "Insight India 2025 - Standortbewertung- und Investitionsbewertung", "Wachstumsstrategie systematisch bewerten und steuern", "Use Case - Globale Marktexpansion"]},
            {"id": "ki_entscheidung", "name": "ü§ñ KI & Entscheidungsintelligenz", "keywords": ["Forecasting mit generativer KI strukturieren", "CFO Control Tower", "Echtzeitsteuerung mit KI-Modellen", "KI-Readiness-Check im CFO-Bereich", "KI-gest√ºtzte Investitionsbewertung", "ROI-Prognose", "Prompt-Design f√ºr Finanzabteilungen standardisieren", "Use Case-Matrix f√ºr KI im CFO-Bereich", "Explainable AI", "CFO-Verst√§ndnis", "Regulatorik absichern", "KI im Monats- und Quartalsreporting einbinden", "Zusammenarbeit von CFO", "KI-Produktteam strukturieren", "Entscheidungsarchitektur f√ºr CFOs mit KI"]},
            {"id": "transformation_operating", "name": "üîÑ Transformation & Operating Model", "keywords": ["Target Operating Model (TOM) CFO-kompatibel ausgestalten", "CFO-Steuerungsmodell f√ºr Transformationen entwickeln", "Shared Services Operating Model der n√§chsten Generation entwickeln", "Rollenver√§nderung im CFO-Bereich gestalten", "Transformationsprojekte systematisch priorisieren", "Agiles Operating Model im CFO-Bereich entwickeln", "Kostenf√ºhrungsmodell entwickeln", "ohne Qualit√§tsverlust", "Transformation Enablement Scorecard entwickeln", "Governance-Struktur f√ºr Transformationen entwickeln", "Finance Shared Services der Zukunft entwickeln", "The Leader in ESG Change Management"]},
            {"id": "digitale_transformation", "name": "üíª Digitale Transformation", "keywords": ["Digitale Vision als CFO mitgestalten", "Finanzielle Bewertung strategisch relevanter Digital-Probleme", "Business Case SSC", "Business Case: 4 Validierungsstufen", "Steuerungsmodell f√ºr skalierbares digitales Wachstum", "Investitionsstrategie f√ºr Tech, Talent", "Kulturaufbau", "Transformation Roadmap erstellen", "Talent Bench aufbauen", "Neues Operating Model adaptieren", "Technologie-Infrastruktur f√ºr Innovation aufbauen", "Datenorganisation", "-kultur etablieren", "Adoption", "Skalierung absichern"]},
            {"id": "finance_excellence", "name": "‚≠ê Finance Excellence & Steuerung", "keywords": ["Finance Operating Model bewerten und weiterentwickeln", "Shared Services vs. dezentrale Steuerung", "Modell bewerten und ausrichten", "Reifegradmodell f√ºr den CFO-Bereich entwickeln", "Performance Management System aufbauen", "Steuerungsarchitektur f√ºr Business Partnering im Controlling entwickeln", "Planungsprozess auf Effektivit√§t", "Relevanz pr√ºfen", "Effizienzpotenziale im Finanzbereich identifizieren und heben", "Kostenrechnungssysteme auf Aktualit√§t", "Steuerungslogik pr√ºfen", "Governance-", "Kontrollsystem im CFO-Bereich st√§rken", "Exzellenzinitiative im CFO-Team entwickeln"]},
            {"id": "finanzierung_kapitalstruktur_cfo", "name": "üíº Finanzierung & Kapitalstruktur", "keywords": ["Kapitalstruktur analysieren", "Zielstruktur definieren", "Finanzierungsstrategie kurz- und langfristig entwickeln", "Kreditportfolio", "Bankenstrategie steuern", "Leverage-Ratio", "Zinsdeckungsgrad im Szenario pr√ºfen", "Alternative Finanzierungsquellen bewerten", "Cash Conversion Cycle", "Working Capital gezielt steuern", "Finanzierung von M&A-Transaktionen strukturieren", "Eigenkapitalinstrumente f√ºr Wachstumsphasen gestalten", "Zinsmanagement", "Refinanzierungsstrategie aktiv gestalten", "Kapitaldienstf√§higkeit im Planungsmodell simulieren"]},
            {"id": "ma_beteiligung", "name": "ü§ù M&A & Beteiligungsstrategie", "keywords": ["Ist der geplante Deal strategisch kapitalgerecht", "Freigabeentscheidung f√ºr einen M&A-Deal", "Ja oder Nein", "Beteiligungsstrategie auf Gruppenebene entwickeln", "Zielrendite und Wertsteigerungshebel bei Beteiligungen definieren", "Welche Rolle spielt der CFO in M&A-Freigabeprozess", "Werttreiberlogik in Buy-&-Build-Strategien bewerten", "Vorschlag f√ºr Divestment oder Carve-Out strategisch bewerten", "Post-Merger-Zielsteuerung aus CFO-Sicht definieren", "Beteiligung in der Krise", "Sanierungsentscheidung treffen", "Szenariobasierte Bewertung der M&A-Finanzierung", "Kapitalbindung"]},
            {"id": "strategisches_kostenmanagement", "name": "üìä Strategisches Kostenmanagement", "keywords": ["Strategische Prinzipien f√ºr ein gruppenweites Effizienzprogramm", "Versteckte Kosten- und Komplexit√§tstreiber identifizieren", "Zero-Based Budgeting (ZBB) intelligent umsetzen", "ohne operative L√§hmung", "KPI-Logik f√ºr Cost-Reduction-Initiativen aufsetzen", "Kostensenkung bewerten: Wirkung, Nachhaltigkeit, Nebenwirkung", "Target Operating Model (TOM) auf Kostenlogik pr√ºfen", "Kostenbewusstsein in den Business Units verankern", "ohne Micromanagement", "Cost Transformation Program aufsetzen", "Struktur, Rollen, KPI", "Synergieziele aus M&A in der GuV verankern", "nachhalten", "Capex-Einsparungen entscheidungsf√§hig aufbereiten"]},
            {"id": "capital_allocation", "name": "üí° Capital Allocation & Investment Logic", "keywords": ["Capital Allocation Strategy entwickeln", "Wachstum, Risiko und Rendite balancieren", "Investitionsprojekte vergleichbar bewerten und priorisieren", "CFO-Freigabe im Investment Committee definieren", "Cash-zu-Wachstum-Logik optimieren", "Capex, M&A, Dividende, Buybacks", "Innovations-", "Technologieinvestitionen bewerten", "aus CFO-Perspektive", "Scoring-Modell f√ºr Investitionsentscheidungen entwickeln", "Kapitalallokation √ºber Regionen", "Business Units steuern", "Capital Turnover", "Asset Efficiency steuern", "Wirkung auf RoCE", "Wertsch√∂pfung verstehen", "Post-Investment Review aufsetzen", "Wirkung und Lernprozesse sicherstellen", "Investment Governance verankern", "Entscheidungsrahmen und Reifegrad sichern"]},
            {"id": "geopolitische_resilienz", "name": "üåç Geopolitische Resilienz & ...", "keywords": ["Integriertes Enterprise Risk Management (ERM)", "Risikosteuerung im Forecast-", "Planungsprozess verankern", "Cyber-Risiken finanziell bewerten und CFO-wirksam steuern", "Technologische Abh√§ngigkeit", "Legacy-Risiken bewerten", "Regulatorische ESG-Risiken systematisch identifizieren", "finanziell bewerten", "Reputationsrisiken fr√ºhzeitig identifizieren", "absichern", "ESG-Risikobewertung in Investitionsentscheidungen verankern", "Standortrisiken", "Handelsabh√§ngigkeiten systematisch bewerten", "Geopolitische Szenarien in der Finanzplanung ber√ºcksichtigen", "Sanktions-", "Exportkontrollrisiken strategisch absichern", "Zinsrisiken erkennen, bewerten", "strategisch steuern"]}
        ]
    },
    "M&A": {
        "icon": "ü§ù",
        "themes": [
            {"id": "prozesse_rollen", "name": "‚öôÔ∏è M&A Prozesse & Rollen", "keywords": ["M&A Prozess√ºberblick f√ºr die Sell-Side", "M&A Prozess√ºberblick f√ºr die Buy-Side", "Bieterverfahren vs. Exklusivprozess", "Sell-Side Perspektive", "Bieterverfahren vs. Exklusivprozess", "Buy-Side Perspektive", "Erstellung einer M&A Stakeholder Map", "Erstellung einer typischen M&A-Transaktionstimeline", "√úbersicht der Beraterrollen im M&A-Prozess", "Ma√ünahmen zur Transaktionsvorbereitung", "Sell-Side"]},
            {"id": "gestaltungsformen", "name": "üìã Gestaltungsformen und ...", "keywords": ["Share Deal √úberblick", "Asset Deal √úberblick", "Kombinationsmodelle: Share Deal + Asset Deal", "Carve-Outs", "Internationale M&A-Transaktionen", "Cross-Border Deals", "Strategische Investoren vs. Finanzinvestoren", "Unterschiede und Auswirkungen", "Public M&A vs. Private M&A", "Unterschiede, Ablauf und Besonderheiten", "Besondere Transaktionsformen: MBO, MBI, Joint Venture, Merger"]},
            {"id": "pre_deal", "name": "üéØ Pre-Deal Phase", "keywords": ["Durchf√ºhrung einer professionellen Marktanalyse", "Erstellung einer Target-Liste und Target Screening", "Deal Sourcing: Strategien und Kan√§le f√ºr die Identifikation von Targets", "Bieterverfahren vs. Exklusivprozess", "Buy-Side Perspektive", "Erstansprache potenzieller Targets", "Erstellung eines Teasers und Information Memorandum", "Erstellung eines NDA", "Non-Disclosure Agreement", "Erstellung eines Letter of Intent", "LOI", "Ma√ünahmen zur Transaktionsvorbereitung", "Sell-Side"]},
            {"id": "strategic_dd", "name": "üîç Strategic FIT Due Diligence", "keywords": ["Notwendigkeit einer Strategic Due Diligence", "Inhalte einer Strategic Due Diligence", "Ablauf einer Strategic Due Diligence", "Ermittlung und Quantifizierung von Synergiepotenzialen", "Advanced Prompt", "Synergie Scoring Modell / Business Model Canvas f√ºr Strategic Due Diligence"]},
            {"id": "commercial_dd", "name": "üíº Commercial FIT Due Diligence", "keywords": ["Grundlagen", "Zielsetzung der Commercial DD", "Markt- und Branchenanalyse", "Kunden- und Wettbewerbsanalyse", "Gesch√§ftsmodellanalyse", "Positionierung", "Validierung der Business-Planung", "Risikoanalyse", "Verkn√ºpfung der CDD mit der Unternehmensbewertung"]},
            {"id": "financial_dd", "name": "üí∞ Financial Due Diligence", "keywords": ["Erstellung einer vollst√§ndigen Financial Due Diligence Checkliste", "Durchf√ºhrung einer Quality of Earnings", "QoE", "Analyse", "Normalisierung von Ertr√§gen und Aufwendungen", "Durchf√ºhrung einer Working Capital Analyse", "Durchf√ºhrung einer Net Debt Analyse", "Analyse und Plausibilisierung des Business Plans", "Red Flag Analyse", "Aufbau eines vollst√§ndigen Financial Due Diligence Reports", "Case-Prompt: Quality of Earnings Analyse mit konkreten Zahlen"]},
            {"id": "tax_dd", "name": "üìä Tax Due Diligence", "keywords": ["Erstellung einer vollst√§ndigen Tax Due Diligence Checkliste", "Identifikation typischer steuerlicher Risiken", "Red Flags", "K√∂rperschaftsteuer Due Diligence", "Gewerbesteuer Due Diligence", "Umsatzsteuer Due Diligence", "Lohnsteuer Due Diligence", "Tax Compliance", "Betriebspr√ºfungsrisiken", "Internationale Steuerfragen in der Tax Due Diligence", "Steuerliche Themen im SPA"]},
            {"id": "legal_dd", "name": "‚öñÔ∏è Legal Due Diligence", "keywords": ["Erstellung einer vollst√§ndigen Legal Due Diligence Checkliste", "Gesellschaftsrechtliche Pr√ºfung", "Pr√ºfung gewerblicher Schutzrechte", "Miet-, Pacht- und Leasingvertr√§ge", "Vertrags- und Vertriebsrecht", "Arbeitsrechtliche Due Diligence", "Compliance, Litigation", "beh√∂rdliche Verfahren", "Change-of-Control-Klauseln", "M&A-relevante Vertragsregelungen", "Red Flag Analyse", "Advanced Prompt", "Software-", "Quellcode-Eigentumsanalyse", "Advanced Prompt", "Open Source", "Compliance"]},
            {"id": "bewertung", "name": "üìà Unternehmensbewertung", "keywords": ["Unternehmensbewertung nach IDW S1", "Plausibilisierung der Planungsrechnung", "Unternehmensbewertung mittels DCF-Verfahren", "Durchf√ºhrung einer Quality of Earnings", "QoE", "Analyse", "Durchf√ºhrung einer Working Capital Analyse", "Durchf√ºhrung einer Net Debt Analyse", "Analyse und Plausibilisierung des Business Plans", "Red Flag Analyse", "Bewertungsfallen", "Aufbau eines vollst√§ndigen Financial Due Diligence Reports", "Case prompt", "Sensitivit√§tsanalyse zur Unternehmensbewertung", "Case prompt", "Unternehmensbewertung", "DCF-Entity Approach"]},
            {"id": "kaufvertrag", "name": "üìÑ Kaufvertragsgestaltung", "keywords": ["Erstellung eines vollst√§ndigen SPA-Grundger√ºsts", "Kaufpreisgestaltung im SPA", "Garantien", "Freistellungen", "Warranties", "Indemnities", "Covenants", "Pre-Closing-Verpflichtungen", "Closing Conditions", "Vollzugsbedingungen im SPA", "Haftungsregelungen im SPA", "Haftungsh√∂he, Dauer, Cap, Basket", "Streitbeilegung", "Gerichtsstand", "Schiedsgericht, ordentliche Gerichtsbarkeit, Rechtswahl", "Strukturierung einer W&I Insurance im M&A-Prozess"]},
            {"id": "pmi", "name": "üîÑ Post-Merger-Integration", "keywords": ["Grundlagen und Zielsetzung", "PMI", "PMI-Planung und Governance", "Entwicklung der Integrationsstrategie", "Synergieplanung und Synergietracking", "Kommunikationsstrategie", "intern", "extern", "Integration der Organisation", "HR, Kultur, Change-Management", "Operative Integration", "Prozesse, IT, Controlling, Einkauf, Vertrieb", "Advanced M&A Controlling", "Monitoring inkl. Synergietracking, KPI-System", "Risiko-Reporting", "Lessons Learned", "Optimierung nach der PMI"]},
            {"id": "finanzierung_ma", "name": "üíµ Finanzierung", "keywords": ["Strukturierung der Akquisitionsfinanzierung", "Debt / Equity", "Bestimmung der optimalen Eigenkapitalquote und Leverage im M&A-Deal", "Strukturierung von Senior Debt, Mezzanine und Equity im Rahmen der Akquisitionsfinanzierung", "Covenants und Finanzierungsbedingungen im M&A-Deal", "Planung der Schuldendienstf√§higkeit und Cashflow-Sicherheit", "Simulation von Leverage-Effekten inkl. Eigenkapitalrendite und Value Creation", "Bankprozess", "Debt Advisory", "Banken, Unterlagen, Verhandlungen", "Vertragswerke im Finanzierungsprozess", "Term Sheet, Kreditvertrag, Intercreditor Agreement", "Besonderheiten bei Private Equity, Leveraged Buy-Outs", "LBO", "Management Buy-Outs", "MBO", "Integration der Debt-Finanzierung in SPA und Unternehmensbewertung", "Post-Deal-Finanzierung und Refinanzierung", "Working Capital Facilities, Umschuldung, Optimierung"]},
            {"id": "distressed", "name": "üÜò Distressed M&A", "keywords": ["Besonderheiten und Grundz√ºge von Distressed M&A", "Ablauf einer typischen Distressed M&A Transaktion", "Pr√ºfung der insolvenzrechtlichen Situation", "Kaufgegenstand", "Deal-Struktur", "Erstellung einer M&A Stakeholder Map", "Digital Due Diligence in der Krise", "Schutzmechanismen im Kaufvertrag bei Distressed M&A", "Kaufpreisfindung und Earn-Outs im Distressed M&A", "Finanzierung von Distressed M&A-Transaktionen", "Stakeholder-Management im Distressed M&A", "Arbeitsrecht und Personal im Distressed M&A", "Betriebs√ºbergang, ¬ß 613a BGB, Sozialplan", "Post-Deal-Phase im Distressed M&A"]},
            {"id": "vc_growth", "name": "üöÄ Venture Capital & Growth Equity", "keywords": ["Grundlagen", "Besonderheiten von VC- und Growth Equity-Transaktionen", "Deal-Strukturen im VC", "Growth Equity", "Unternehmensbewertung in VC", "Due Diligence im VC-Umfeld", "Financial, Legal, IP, Commercial", "Term Sheet in VC-Deals", "Cap Table Management", "Verw√§sserung", "vor und nach der Finanzierungsrunde", "Gesellschaftervereinbarung", "Investor Rights Agreement", "Exit-Szenarien und Beteiligungscontrolling", "IPO, Trade Sale, Secondary", "Growth Equity Besonderheiten", "Praxisfall: Investment in ein SaaS-Start-up"]},
            {"id": "verhandlung", "name": "ü§ù Verhandlungsf√ºhrung & Deal Tactics", "keywords": ["Verhandlungsvorbereitung", "Zieldefinition, BATNA, Verhandlungsstrategie", "Integrative vs. Distributive Verhandlungsans√§tze wie z.B. Win-Win vs. Harvard-Konzept angewendet", "Verhandlungstaktiken", "Typische Verhaltensweisen von K√§ufer und Verk√§ufer", "Priorisierung der Verhandlungsgegenst√§nde", "inkl. Konfliktintensit√§tsmatrix", "Nutzung von Verhandlungsmacht, Deal Timing und taktischen Deadlines", "Kommunikations- und Verhandlungstechniken", "Signale, Sprache, K√∂rpersprache", "Buy-Side Verhandlungstaktik", "Optimale Vorbereitung und Umsetzung", "Sell-Side Verhandlungstaktik", "Deal Protection und Kaufpreismaximierung", "Umgang mit schwierigen Verhandlungen und Deadlocks", "Negotiation Playbook", "Checklisten, Templates", "Deal Scoring"]}
        ]
    },
    "Bilanzbuchhalter": {
        "icon": "üìö",
        "themes": [
            {"id": "zwecke_grundsaetze", "name": "üìã Zwecke und Grunds√§tze der ...", "keywords": ["Zwecke des Jahresabschlusses", "Grundsatz der Richtigkeit", "Grundsatz der Vergleichbarkeit", "Grundsatz der Klarheit", "Grundsatz der Vollst√§ndigkeit", "Bilanzstichtagsprinzip", "Werterhellend vs. Wertbegr√ºndet", "Periodisierungsprinzip", "Realisationsprinzip", "Imparit√§tsprinzip", "Vorsichtsprinzip"]},
            {"id": "allgemeine_ansatz", "name": "‚öñÔ∏è Allgemeine Ansatzregeln", "keywords": ["Kalkulationssimulation", "Was passiert bei Preis-, Kosten- oder Mengen√§nderungen", "Aktivierungsf√§higkeit nach HGB", "abstrakt", "konkret", "Aktivierungsverbot nach ¬ß 248 Abs. 2 HGB", "Aktivierungswahlrechte", "Entwicklungskosten und Disagio", "Aktivierungsgebote bei Nicht-Verm√∂gensgegenst√§nden", "z.B. RAP", "Disagio", "Zurechnung von Verm√∂gensgegenst√§nden", "wirtschaftliches vs. rechtliches Eigentum", "Passivierungsf√§higkeit", "Drei Kriterien f√ºr Schulden", "Abgrenzung: R√ºckstellung oder Eventualverbindlichkeit", "Ansatzgrunds√§tze in der Steuerbilanz", "Ma√ügeblichkeitsprinzip", "Abweichungen zum HGB", "Ansatzvorschriften nach IFRS", "Unterschiede zu HGB und ESTG systematisch darstellen"]},
            {"id": "allgemeine_bewertung", "name": "üí∞ Allgemeine Bewertungsregeln", "keywords": ["Grundprinzipien der Bewertung", "√úberblick", "GoB-Anbindung", "Zugangsbewertung von Verm√∂gensgegenst√§nden", "Anschaffung, Herstellung, Bewertung", "Folgebewertung", "Niederstwertprinzip und Zuschreibungspflicht", "Bewertung von Schulden", "Erf√ºllungsbetrag und R√ºckstellungen", "Bewertungsvereinfachungsverfahren", "FIFO, LIFO, Durchschnittsmethode", "Bewertungseinheiten und Sicherungsbeziehungen", "¬ß 254 HGB richtig anwenden", "W√§hrungsumrechnung bei Bilanzansatz", "¬ß 256a HGB richtig anwenden", "IFRS-Bewertungskonzepte im Vergleich", "Fair Value vs. Anschaffungs-/Herstellungskosten", "Wertaufhellung vs. Wertbegr√ºndung", "Bilanzstichtagsprinzip richtig anwenden", "Bewertungsma√üst√§be in der Steuerbilanz", "Unterschiede", "Einschr√§nkungen nach ESTG"]},
            {"id": "anlagevermoegen", "name": "üè≠ Bilanzierung des Anlageverm√∂gens", "keywords": ["Aktivierung von Sachanlagen", "Anschaffungsnebenkosten", "nachtr√§gliche AK", "richtig erfassen", "Nachtr√§gliche Anschaffungskosten", "Erweiterungen und Erneuerungen an Anlagen", "Abgrenzung aktivierungspflichtiger, -f√§higer und -verbotener Posten", "Aktivierung selbst erstellter immaterieller Verm√∂genswerte bei teilweise Fremdvergabe", "z.B. Software", "Abgrenzung Anlageverm√∂gen vs. Umlaufverm√∂gen", "Zurechnung von Verm√∂gensgegenst√§nden", "Bilanzierung von Finanzanlagen", "Herstellungskosten", "¬ß 255 Abs. 2 und 3 HGB", "Abgrenzung", "Zurechnung von Wirtschaftsg√ºtern bei abweichender zivilrechtlicher und wirtschaftlicher Zugeh√∂rigkeit", "HGB, IFRS, ESTG", "Bewertung b√∂rsennotierter Wertpapiere", "Umlaufverm√∂gen, HGB", "Bilanzierung nicht b√∂rsennotierter Beteiligungen", "Finanzanlageverm√∂gen, HGB", "Zuschreibungen bei Wertaufholung", "¬ß 253 Abs. 5 HGB", "Abgrenzung derivativer Finanzinstrumente", "z.B. Optionen, Swaps, Futures", "Hedging", "Bewertung von Sicherungsgesch√§ften nach HGB", "Verkauf und Ausbuchung von Finanzinstrumenten", "HGB", "Bilanzierung von Finanzinstrumenten bei Kreditinstituten", "RechKredV", "Vergleich HGB vs. IFRS bei der Bilanzierung von Finanzinstrumenten", "Vergleich HGB vs. US GAAP bei der Bilanzierung von Finanzinstrumenten"]},
            {"id": "vorratsvermoegen", "name": "üì¶ Bilanzierung des Vorratsverm√∂gens", "keywords": ["Definition", "Abgrenzung: Was geh√∂rt zum Vorratsverm√∂gen", "Zugangsbewertung von Vorr√§ten gem√§√ü ¬ß 255 Abs. 1 und Abs. 2 HGB", "Folgebewertung von Vorr√§ten nach dem Niederstwertprinzip", "¬ß 253 Abs. 4 HGB", "Bewertungsvereinfachungsverfahren bei Vorr√§ten", "Teilwertabschreibung bei Vorr√§ten", "steuerliche Bewertung bei dauerhafter Wertminderung", "Bewertung von Roh-, Hilfs- und Betriebsstoffen", "Zugangs- und Stichtagsbewertung nach HGB", "Bewertung unfertiger Erzeugnisse", "Herstellungskosten, Teilwert und Bilanzierungswahlrechte", "Bewertung fertiger Erzeugnisse", "Niederstwertprinzip, Marktpreis und Teilwert", "Bewertung von Handelswaren", "Strenges Niederstwertprinzip und Teilwertpr√ºfung", "Bewertung des Vorratsverm√∂gens nach IFRS", "Bewertung des Vorratsverm√∂gens nach US GAAP"]},
            {"id": "forderungen", "name": "üìÑ Bilanzierung der Forderungen", "keywords": ["Bilanzierung von Forderungen aus Lieferungen und Leistungen nach HGB und ESTG", "Zweifelhafte Forderungen: Teilwertabschreibung und Pauschalwertberichtigung", "Pauschalwertberichtigung auf Forderungen nach HGB und ESTG", "Bilanzierung uneinbringlicher Forderungen", "Vollwertabschreibung", "Pauschalwertberichtigung auf Forderungen", "Einzel-", "Gruppenrisiken", "Umsatzsteuerliche Korrekturen bei uneinbringlichen Forderungen", "¬ß17 UStG", "Ausweis", "Erl√§uterungspflichten zu Verbindlichkeiten", "¬ß 266", "¬ß 285 HGB", "Bilanzierung von Forderungen nach IFRS", "Klassifikation, Bewertung", "Ausweis", "Verbindlichkeiten nach US GAAP", "Klassifikation, Bewertung", "Debt Modification", "Verbindlichkeiten im Vergleich", "HGB, IFRS", "US GAAP gegen√ºberstellen", "bewerten"]},
            {"id": "finanzinstrumente", "name": "üíº Bilanzierungen von Finanzinstrumenten", "keywords": ["Klassifizierung von Finanzinstrumenten", "HGB", "Bewertung b√∂rsennotierter Wertpapiere", "Umlaufverm√∂gen, HGB", "Bilanzierung nicht b√∂rsennotierter Beteiligungen", "Finanzanlageverm√∂gen, HGB", "Zuschreibungen bei Wertaufholung", "¬ß 253 Abs. 5 HGB", "Abgrenzung derivativer Finanzinstrumente", "z.B. Optionen, Swaps, Futures", "Hedging", "Bewertung von Sicherungsgesch√§ften nach HGB", "Verkauf und Ausbuchung von Finanzinstrumenten", "HGB", "Bilanzierung von Finanzinstrumenten bei Kreditinstituten", "RechKredV", "Vergleich HGB vs. IFRS bei der Bilanzierung von Finanzinstrumenten", "Vergleich HGB vs. US GAAP bei der Bilanzierung von Finanzinstrumenten"]},
            {"id": "eigenkapital", "name": "üíé Bilanzierung des Eigenkapitals", "keywords": ["Funktion, Gliederung und Bedeutung des Eigenkapitals nach HGB", "Bilanzierung des gezeichneten Kapitals", "Zugang, Bewertung, Handelsregistereintrag", "Ausstehende Einlagen auf das gezeichnete Kapital nach ¬ß 272 Abs. 1 HGB", "Kapitalerh√∂hung", "Bilanzierung des gezeichneten Kapitals und der Kapitalr√ºcklage", "Kapitalherabsetzung", "Bilanzielle Behandlung und Ausweis", "Kapitalzuschuss nach ¬ß 272 Abs. 2 HGB", "Bilanzierung, Arten und Ausweis", "Gewinnr√ºcklagen nach ¬ß 272 Abs. 3-5 HGB", "Bildung, Ausweis", "Gewinn-/Verlustvortrag", "Bilanzierung und Ausweis in Jahresabschluss", "Jahres√ºberschuss / Jahresfehlbetrag", "Ausweis, Verrechnung und Dokumentation", "Sonder-", "Erg√§nzungskapitalkonten bei Personengesellschaften", "Bilanzierung", "Ausweis", "Inkongruente Gewinnaussch√ºttung", "Steuerlich zul√§ssige Gestaltung und Bilanzwirkung", "Disquotalen Einzahlung in die Kapitalr√ºcklage bei GmbHs"]},
            {"id": "verbindlichkeiten", "name": "üîó Bilanzierung von Verbindlichkeiten", "keywords": ["Begriff und Arten von Verbindlichkeiten", "Abgrenzung, Systematik", "Ausweis", "Ansatz und Bewertung von Verbindlichkeiten", "Grunds√§tze nach ¬ß 253 HGB", "Verbindlichkeiten mit Differenz zwischen Auszahlung und R√ºckzahlung", "Abzinsung, Disagio", "Unverzinsliche Verbindlichkeiten aus Rentenverpflichtungen", "Barwert, Laufzeit", "Bewertung", "Verbindlichkeiten mit Skonto", "Bewertung zum Erf√ºllungsbetrag", "Behandlung von Skonto", "Fremdw√§hrungsverbindlichkeiten", "Zugang, Umrechnung", "Bewertung nach ¬ß 256a HGB", "Ausweis", "Erl√§uterungspflichten zu Verbindlichkeiten", "¬ß 266", "¬ß 285 HGB", "Bilanzierung von Verbindlichkeiten nach IFRS", "Klassifikation, Bewertung", "Ausweis", "Verbindlichkeiten nach US GAAP", "Klassifikation, Bewertung", "Debt Modification", "Verbindlichkeiten im Vergleich", "HGB, IFRS", "US GAAP gegen√ºberstellen", "bewerten"]},
            {"id": "rueckstellungen", "name": "üìä Bilanzierung der R√ºckstellungen", "keywords": ["R√ºckstellungen", "Begriff, Zweck", "Abgrenzung zu Verbindlichkeiten", "¬ß 249 HGB", "R√ºckstellungen in der Steuerbilanz", "Ma√ügeblichkeit", "R√ºckstellungsverbot", "¬ß 5 Abs. 1 und 4 AO", "R√ºckstellungen f√ºr ungewisse Verbindlichkeiten", "Ansatz, Nachweis", "Dokumentation", "R√ºckstellungen f√ºr unterlassene Instandhaltung und Abraumbeseitigung", "R√ºckstellungen f√ºr Gew√§hrleistungen ohne rechtliche Verpflichtungen und Kulanz", "R√ºckstellungen f√ºr Steuern", "Bewertung von R√ºckstellungen", "Erf√ºllungsbetrag, Abzinsung und Erfahrungswerte", "¬ß 253", "Bilanzierung von Drohverlustr√ºckstellungen bei schwebenden Gesch√§ften", "R√ºckstellungen f√ºr Pensionen und √§hnliche Verpflichtungen", "R√ºckstellungen f√ºr Altersversorgungsverpflichtungen", "BilMoG-Regeln", "Abzinsung", "Anhangangaben zu R√ºckstellungen gem√§√ü ¬ß 285 Nr. 12 HGB", "R√ºckstellungen nach IFRS", "IAS 37", "Ansatz, Bewertung, Unterschiede zum HGB", "R√ºckstellungen nach US GAAP", "ASC 450", "Contingencies", "Probabilities", "Vergleich R√ºckstellungen HGB", "IFRS", "US GAAP", "Ansatz, Bewertung, Offenlegung", "R√ºckstellungen f√ºr Dienstjubil√§en"]},
            {"id": "besondere_posten", "name": "üìå Besondere Bilanzposten", "keywords": ["Begriff", "Funktion von Rechnungsabgrenzungsposten", "¬ß 250 HGB", "Active Rechnungsabgrenzungsposten", "Voraussetzungen, Abgrenzung, Beispiele", "Passive Rechnungsabgrenzungsposten", "Voraussetzungen, Besonderheiten bei Anzahlungen", "Abgrenzung RAP zu Verbindlichkeiten", "R√ºckstellungen", "Latente Steuern", "Grundlagen", "gesetzliche Vorgaben", "¬ß 274 HGB, IFRS", "Active latente Steuern", "Ansatz, Bewertung, Verlustvortr√§ge", "Passive latente Steuern", "Entstehung, Abgrenzung, Beispiel", "Latente Steuern im IFRS-Abschluss", "IAS 12", "Angabe-", "Ausweisvorschriften zu latenten Steuern", "¬ß 274 HGB, IFRS", "Eventualverbindlichkeiten", "Haftungsverh√§ltnisse", "¬ß 251 HGB", "B√ºrgschaften, Patronatserkl√§rungen, Sicherheiten", "Bilanzierung und Offenlegung", "Angabepflichten bei nicht bilanzierungsf√§higen Verpflichtungen", "Vergleich", "Bilanzierung und Angabe besonderer Posten nach HGB, IFRS und US GAAP"]},
            {"id": "guv", "name": "üìà Gewinn- und Verlustrechnung", "keywords": ["Aufbau, Gliederung und Bedeutung der GuV nach ¬ß 275 HGB", "Gliederung der Gesamtkosten- und Umsatzkostenverfahren", "Wahlrecht, Aufbau und Unterschiede", "Umsatzerl√∂se nach ¬ß 277 Abs. 1 HGB und IFRS 15", "Abgrenzung, Bewertung, zeitliche Zuordnung", "Bestandsver√§nderungen und aktivierte Eigenleistungen", "¬ß 275 Abs. 2 Nr. 2-3 HGB", "Sonstige betriebliche Ertr√§ge", "Aufwendungen", "Personalaufwand", "¬ß 275 Abs. 2 Nr. 6 HGB", "Abschreibungen auf immaterielle Verm√∂gensgegenst√§nde und Sachanlagen", "¬ß 275 Abs. 2", "Ertr√§ge und Aufwendungen aus Beteiligungen, Wertpapieren und Finanzinstrumenten", "Zinsertr√§ge und Zinsaufwendungen", "handelsrechtlicher Ausweis und IFRS-Abgrenzung", "¬ß 275", "Ergebnis aus W√§hrungsumrechnung und Kurssicherung", "GuV-Ausweis und Bewertung nach HGB", "Au√üerordentliche Ertr√§ge", "Aufwendungen", "handelsrechtliche Bedeutung und praktische Anwendung", "Jahres√ºberschuss und Bilanzgewinn", "Ableitung, Einflussgr√∂√üen und Gestaltungsspielr√§ume", "Ergebnisverwendung im Einzelabschluss vs. Konzernabschluss", "handelsrechtliche Unterschiede"]},
            {"id": "anhang", "name": "üìù Anhang", "keywords": ["Zweck, Funktion und Struktur des Anhangs", "¬ß¬ß 284‚Äì285 HGB", "Bilanzierungs- und Bewertungsmethoden im Anhang", "¬ß 284 Abs. 2 HGB", "Anhangangaben zu R√ºckstellungen gem√§√ü ¬ß 285 Nr. 12 HGB", "Verbindlichkeiten, Sicherheiten und Restlaufzeiten im Anhang", "¬ß 285 Nr. 1-3 HGB", "Anhangangaben zu Anteilseignern, Beteiligungen und Organen", "¬ß 285 Nr. 10-11a HGB", "Angaben zur Ergebnisverwendung und Aussch√ºttung im Anhang", "¬ß 285 Nr. 13 HGB, ¬ß 158", "Freiwillige Angaben", "Best Practices im Anhang", "z.B. ESG, Kennzahlen, Risikoangaben", "Gr√∂√üenabh√§ngige Erleichterungen", "Wegfasslisten nach ¬ß 288 HGB", "Haftungsverh√§ltnisse", "Eventualverbindlichkeiten", "¬ß 251 HGB", "¬ß 285 Nr. 3 HGB", "Nachtragsberichterstattung", "Ereignisse nach dem Bilanzstichtag", "¬ß 285 Abs. 33 HGB", "Angaben zu Beteiligungen", "Tochterunternehmen", "¬ß 285 Nr. 11", "¬ß 313 HGB", "Exklusiv: Vollst√§ndiger Anhang"]},
            {"id": "lagebericht", "name": "üìÑ Lagebericht", "keywords": ["Grundlagen des Lageberichts: Funktionen, Zielsetzung", "gesetzliche Grundlagen", "¬ß 289", "Inhalt des Lageberichts: Pflichtbestandteile nach ¬ß 289 Abs. 1 HGB", "Forschungs- und Entwicklungsaktivit√§ten im Lagebericht", "¬ß 289 Abs. 2 Nr. 1 HGB", "Darstellung des Gesch√§ftsverlaufs im Lagebericht", "¬ß 289 Abs. 1 HGB", "Prognose-, Chancen- und Risikobericht", "¬ß 289 Abs. 1 S. 4 HGB", "inkl. Ausblick", "Risikomanagementsystem", "IKS im Lagebericht", "¬ß 289 Abs. 4 HGB", "f√ºr kapitalmarktorientierte Unternehmen", "Darstellung der Verm√∂gens-, Finanz- und Ertragslage", "VFE-Lage", "Darstellung der Ertragslage im Lagebericht gem√§√ü ¬ß 289 HGB und DRS 20", "Nachtragsbericht im Lagebericht", "Ereignisse nach dem Bilanzstichtag", "¬ß 285 Nr. 33 HGB", "Finanzielle Leistungsindikatoren im Lagebericht", "¬ß 289 Abs. 1 S. 4 HGB", "Nichtfinanzielle Leistungsindikatoren im Lagebericht", "¬ß 289 Abs. 3 HGB", "Erkl√§rung zur Unternehmensf√ºhrung", "¬ß 289f HGB", "Gesamtbild und Vollst√§ndigkeitserkl√§rung im Lagebericht"]},
            {"id": "kapitalflussrechnung", "name": "üíµ Kapitalflussrechnung", "keywords": ["Zweck und Rechtsgrundlagen der Kapitalflussrechnung nach HGB", "¬ß¬ß 264, 297 HGB", "und IFRS", "Grundstruktur und Gliederung der Kapitalflussrechnung nach DRS 21 und IAS 7", "Cashflow aus laufender Gesch√§ftst√§tigkeit", "Cashflow aus Investitionst√§tigkeit", "Cashflow aus Finanzierungst√§tigkeit", "Ableitung der Kapitalflussrechnung aus Bilanz und GuV", "Definition", "Abgrenzung Finanzmittelfonds", "Kapitalflussrechnung im Konzern", "Kapitalflussrechnung nach IFRS", "IAS 7", "Pflichten, Gliederung, Vergleich zu HGB/DRS", "Sonderfragen in der Kapitalflussrechnung", "Leasing, Factoring, Sale-and-Lease-Back", "Pr√ºfung und Plausibilisierung der Kapitalflussrechnung", "Erstellung einer vollst√§ndigen Kapitalflussrechnung durch die KI", "Prompt zur automatisierten Aufstellung"]},
        ]
    },
    "Business Developer": {
        "icon": "üöÄ",
        "themes": [
            {"id": "executive_summary", "name": "üìã Executive Summary", "keywords": ["Zielbild", "Alleinstellungsmerkmal klar kommunizieren", "Gesch√§ftsmodell", "Monetarisierung verst√§ndlich darstelle", "Marktpotenzial und Timing √ºberzeugend formulieren", "Vision", "Langfriststrategie inspirierend formulieren", "Relevante Kennzahlen klar", "√ºberzeugend darstellen", "Zielgruppe und Kundennutzen pr√§gnant beschreiben", "Teamkompetenz", "Gr√ºnderprofil wirkungsvoll darstellen", "Herausforderung", "L√∂sung als Story formulieren", "Nutzenversprechen in einem starken Einstiegssatz formulieren", "Elevator Pitch f√ºr m√ºndliche Vorstellung generieren", "Executive Summary f√ºr ein Bauunternehmen mit Wachstumsvorhaben"]},
            {"id": "unternehmensbeschreibung", "name": "üè¢ Unternehmensbeschreibung", "keywords": ["Gr√ºndungsidee", "Entstehungsgeschichte √ºberzeugend darstellen", "Gesch√§ftszweck", "Zielsetzung klar formulieren", "Rechtsformwahl", "Gr√ºndungsstruktur verst√§ndlich erkl√§ren", "USP", "Alleinstellungsmerkmal professionell herausarbeiten", "Standortwahl", "regionale Positionierung fundiert begr√ºnden", "Unternehmensstruktur", "Rollenverteilung √ºbersichtlich darstellen", "Entwicklung seit Gr√ºndung", "wichtige Meilensteine darstellen", "Vision, Leitbild", "langfristige Ausrichtung klar formulieren", "Brancheneinordnung", "Marktumfeld realistisch beschreiben", "Zielgruppen", "Kundensegmente systematisch beschreiben", "Unternehmensprofil f√ºr ein wachsendes Bauunternehmen pr√§gnant beschreiben"]},
            {"id": "produkte_leistungen", "name": "üì¶ Produkte & Leistungen", "keywords": ["Angebot klar und verst√§ndlich beschreiben", "Leistungsumfang", "Abgrenzung zu anderen Anbietern darstellen", "Leistungstiefe", "Wertsch√∂pfung verst√§ndlich erl√§utern", "Angebot modular oder als Paketstruktur darstellen", "Besonderheiten", "Spezialisierungen wirkungsvoll darstellen", "Preislogik", "Angebotskalkulation transparent erkl√§ren", "Materialeinsatz", "Qualit√§tsanspruch √ºberzeugend darstellen", "Serviceleistungen", "After-Sales-Angebote professionell beschreiben", "Innovationsgrad", "Entwicklungspotenzial des Angebots darstellen", "Referenzprojekte oder Musteranwendungen professionell darstellen", "Bauunternehmen: Leistungsprofil der zwei Br√ºder systematisch beschreiben"]},
            {"id": "markt_wettbewerb", "name": "üéØ Markt & Wettbewerb", "keywords": ["Marktanalyse: Gr√∂√üe, Struktur", "Trends klar darstellen", "Zielregion", "regionale Besonderheiten nachvollziehbar beschreiben", "Wettbewerbsanalyse", "eigene Positionierung professionell darstellen", "Zielgruppenspezifisches Marktpotenzial realistisch einsch√§tzen", "Marktbed√ºrfnisse", "Kundenverhalten gezielt analysieren", "Eintrittsbarrieren", "Marktzugang realistisch einsch√§tzen", "Wettbewerbsvorteile", "Alleinstellungsmerkmale gezielt herausarbeiten", "SWOT-Analyse: St√§rken, Schw√§chen, Chancen", "Risiken systematisch darstellen", "Marktstrategie: Wie du den Markt systematisch bearbeitest", "Referenzprojekte oder Musteranwendungen professionell darstellen", "Bauunternehmen: Markt", "Wettbewerbslage der zwei Br√ºder professionell darstellen"]},
            {"id": "marketing_vertrieb", "name": "üì¢ Marketing & Vertrieb", "keywords": ["Marketingstrategie gezielt formulieren", "Online-", "Offline-Marketing konkret planen", "Vertriebswege", "Angebotsprozess klar darstellen", "Preisstrategie", "Argumentation √ºberzeugend darstellen", "Sichtbarkeit", "Bekanntheit gezielt steigern", "Kundenreaktionen", "Empfehlungsquote gezielt analysieren", "Kooperationen", "Multiplikatoren im Vertrieb gezielt nutzen", "Vertrieb mit kleinem Team oder wenig Zeit effizient gestalten", "Vertriebsst√§rken", "pers√∂nliche Wirkung bewusst einsetzen", "Vertriebsausblick", "Skalierungspotenzial realistisch beschreiben", "Bauunternehmen: Marketing-", "Vertriebsstrategie der zwei Br√ºder √ºberzeugend darstellen"]},
            {"id": "geschaeftsmodell", "name": "üèóÔ∏è Gesch√§ftsmodell & Organisation", "keywords": ["Gesch√§ftsmodell kompakt beschreiben", "Was", "F√ºr wen", "Wie", "Warum es funktioniert", "Online-", "Offline-Marketing konkret planen", "Vertriebswege", "Angebotsprozess klar darstellen", "Preisstrategie", "Argumentation √ºberzeugend darstellen", "Sichtbarkeit", "Bekanntheit gezielt steigern", "Kundenreaktionen", "Empfehlungsquote gezielt analysieren", "Kooperationen", "Multiplikatoren im Vertrieb gezielt nutzen", "Vertrieb mit kleinem Team oder wenig Zeit effizient gestalten", "Vertriebsst√§rken", "pers√∂nliche Wirkung bewusst einsetzen", "Vertriebsausblick", "Skalierungspotenzial realistisch beschreiben", "Bauunternehmen: Marketing-", "Vertriebsstrategie der zwei Br√ºder √ºberzeugend darstellen"]},
            {"id": "finanzierung_foerderung", "name": "üí∞ Finanzierung & F√∂rderung", "keywords": ["Kapitalbedarf realistisch und strukturiert ermitteln", "Finanzierungsmix", "Mittelherkunft verst√§ndlich darstellen", "Investitionsplanung sinnvoll", "stufenweise darstellen", "Betriebsmittelbedarf", "Anlaufkosten realistisch kalkulieren", "F√∂rdermittel gezielt einsetzen", "√ºberzeugend begr√ºnden", "R√ºckzahlungsf√§higkeit", "Kapitaldienst nachvollziehbar erkl√§ren", "Mittelverwendung transparent und bankf√§hig erkl√§ren", "Finanzierung bei Teilzeit- oder Nebenerwerbs¬≠gr√ºndung realistisch darstellen", "Finanzierung bei Unternehmens¬≠√ºbernahme, Beteiligung oder Management-Buy-out", "MBO", "Finanzierungssicherheit", "R√ºcklagenstrategie √ºberzeugend darstellen", "Bauunternehmen: Kapitalbedarf realistisch ermitteln", "f√ºr Zwei-Br√ºder-Team im Garten-", "Tiefbau"]},
            {"id": "finanzplanung_wirtschaftlichkeit", "name": "üìä Finanzplanung & Wirtschaftlichkeit", "keywords": ["Umsatzplanung realistisch", "marktgerecht entwickeln", "Kostenstruktur klar aufbauen", "bewerten", "Deckungsbeitragsrechnung strategisch nutzen", "Break-even-Analyse systematisch herleiten", "Wirtschaftlichkeit", "Rentabilit√§t √ºberzeugend argumentieren", "Liquidit√§tsplanung", "Zahlungsf√§higkeit sichern", "Finanzkennzahlen plausibel berechnen", "darstellen", "Wirkung von Preisgestaltung", "Marge verstehen", "Sensitivit√§tsanalyse", "Szenariorechnung vorbereiten", "Planung f√ºr Reinvestition, Wachstum", "Skalierung", "Bauunternehmen: Finanzplanung", "Wirtschaftlichkeit der zwei Br√ºder strategisch darstellen"]},
            {"id": "steuern_formalitaeten", "name": "üìÑ Steuern & Formalit√§ten", "keywords": ["Rechtsformwahl begr√ºndet darstellen", "Steuerarten", "-pflichten richtig einordnen", "Umsatzsteuer-Pflichten und Optionen verstehen", "Gewinnermittlungsart begr√ºnden und planen", "Buchhaltung", "Aufzeichnungspflichten systematisch darstellen", "Rechnungserstellung korrekt", "professionell planen", "Steuerliche Registrierung", "Startpflichten", "Fragebogen zur steuerlichen Erfassung", "Abgabefristen, Zust√§ndigkeiten", "Steuertermine im Griff", "Zusammenarbeit mit Steuerberater:in oder externem Dienstleister", "Bauunternehmen: Steuerliche Pflichten", "Gr√ºndungsformalit√§ten im √úberblick", "Zwei-Br√ºder-Team"]},
            {"id": "businessplaene", "name": "üíº Business Pl√§ne", "keywords": ["Professionelle Gliederung", "Aufbau eines Businessplans entwickeln", "Businessplan-Zusammenfassung", "1‚Äì2 Seiten", "f√ºr Bank, Zuschuss oder Pitch", "Businessplan gezielt auf Zielgruppen anpassen", "Checkliste: ‚ÄûBin ich bereit zur Abgabe", "Businessplan als internes Steuerungsinstrument nutzen", "Anhang", "Nachweise strukturiert zusammenstellen", "Businessplan digital", "visuell ansprechend gestalten", "Pitchf√§hige Pr√§sentation aus dem Businessplan ableiten", "Wiederverwendbare Textbausteine f√ºr Zusch√ºsse", "Bewerbungen erstellen", "Nutzung", "Iteration: Wie du deinen Businessplan regelm√§√üig aktualisierst", "Zwei-Br√ºder-Bauunternehmen: Kompakte Zusammenfassung", "Einstiegslogik des Businessplans"]},
        ]
    },
    "Fachanwalt Gesellschaftsrecht": {
        "icon": "‚öñÔ∏è",
        "themes": [
            {"id": "rechtsformen_haftung", "name": "‚öñÔ∏è Rechtsformen & Haftungsstruktur", "keywords": ["Vergleich der Gesellschaftsformen", "Haftung, Gr√ºndung", "Investorenf√§higkeit", "Rechtsform", "Bonit√§t", "wie die Wahl der Gesellschaftsform die Finanzierung beeinflusst", "Was ist eine GbR", "und was muss ich als Nichtjurist:in beachten", "Innen- und Au√üenverh√§ltnis in der GbR, oHG", "KG einfach erkl√§rt", "Die oHG in der Praxis", "Chancen, Risiken", "Anwendung f√ºr kleine Unternehmen", "GmbH vs. UG", "Entscheidungshilfe f√ºr Gr√ºnder:innen", "Haftungsrisiken in der GmbH", "Co. KG", "und wie man sie begrenzt", "Die GmbH", "Co. KG im √úberblick", "wie sie funktioniert und wann sie sich lohnt", "Die AG im Mittelstand", "sinnvoll oder √ºberdimensioniert", "Steuerliche Transparenz vs. K√∂rperschaftsbesteuerung", "eine strategische Analyse"]},
            {"id": "gruendung_registrierung", "name": "üìù Gr√ºndung & Registrierung", "keywords": ["Was braucht man zur Gr√ºndung einer GmbH", "Handelsregisteranmeldung verst√§ndlich", "praxisnah erkl√§rt", "Achtung bei Handelsregister-Rechnungen", "wie erkenne ich betr√ºgerische Schreiben", "UG oder GmbH gr√ºnden", "was ist g√ºnstiger, schneller, sicherer", "H√§ufige Fehler bei Gesellschaftsgr√ºndungen", "und wie man sie vermeidet", "GmbH gegr√ºndet", "und jetzt? Die To-do-Liste nach der Eintragung", "Muster-Check: Gesellschaftsvertrag", "was muss wirklich rein", "Der Gr√ºndungsprozess bei der GmbH", "Co. KG", "Schritt f√ºr Schritt", "Gesellschafterwechsel vor oder nach Eintragung", "was ist zu beachten", "Vorratsgesellschaft kaufen oder selbst gr√ºnden", "Entscheidungshilfe f√ºr Gesch√§ftsf√ºhrer:innen"]},
            {"id": "einzelunternehmen", "name": "üë§ Einzelunternehmen", "keywords": ["Was ist ein Einzelunternehmen", "und f√ºr wen eignet es sich", "Wie gr√ºnde ich ein Einzelunternehmen", "Schritt f√ºr Schritt erkl√§rt", "Wie l√§uft die Gewerbeanmeldung f√ºr Einzelunternehmer:innen ab", "Haftung im Einzelunternehmen", "was bedeutet das konkret", "Freiberuf oder Gewerbe", "Was bin ich eigentlich, und warum ist das so wichtig", "Wie beende ich ein Einzelunternehmen", "und was muss ich beachten", "Was muss auf Rechnungen eines Einzelunternehmens stehen", "Vom Einzelunternehmen zur GmbH", "wie funktioniert der Wechsel", "Was muss ich als Einzelunternehmer:in auf Social Media beachten", "Die AG im Mittelstand", "sinnvoll oder √ºberdimensioniert"]},
            {"id": "gbr", "name": "üè¢ GbR - Gesellschaft b√ºrgerlichen Rechts", "keywords": ["Begriff und Wesen der GbR - Anwendungsbereiche", "Die Gr√ºndung einer GbR", "Voraussetzungen, Ablauf und Formerfordernisse", "Das Innenverh√§ltnis der GbR", "Gesch√§ftsf√ºhrung, Entscheidungsfindung und interne Haftung", "Das Au√üenverh√§ltnis der GbR", "Vertretung und externe Haftung", "Inhalte und Struktur eines GbR-Gesellschaftsvertrags", "Regelungsbereiche und Gestaltungsspielr√§ume", "Auftritt und Au√üenwahrnehmung der GbR", "Namensf√ºhrung, Impressum und Unternehmensauftritt", "GbR, oHG oder eGbR?", "Rechtsformwahl, Abgrenzung und Schwellenpr√ºfung", "Gesellschafterwechsel in der GbR", "Eintritt, Austritt und Nachfolgeregelung rechtskonform", "Wie beende ich eine GbR", "und worauf muss ich achten", "Haftung richtig begrenzen", "Vertragsgestaltung", "Risikovorsorge in der GbR"]},
            {"id": "ohg", "name": "üè™ OHG - offene Handelsgesellschaft", "keywords": ["Begriff und Rechtsnatur der oHG", "Abgrenzung zur GbR und Bedeutung als Handelsgesellschaft", "Gr√ºndung einer oHG", "Schritte, Anmeldung und Handelsregistereintrag", "Gesellschaftsvertrag der oHG", "gesetzliche Vorgaben und empfohlene Regelungen", "Innenverh√§ltnis der oHG", "Gesch√§ftsf√ºhrung, Stimmrechte und Beschlussfassung", "Beschlussfassung in der oHG", "Mehrheiten, Vetorechte und Sonderregelungen", "Au√üenverh√§ltnis der oHG", "Vertretungsmacht, Vertragsbindung und Publizit√§tspflichten", "Pflichten als Kaufleute", "Buchf√ºhrung, Wettbewerbsverbot, Offenlegung", "Haftung der Gesellschafter", "Umfang, Besonderheiten und Begrenzungsm√∂glichkeiten", "Gesellschafterwechsel in der oHG", "Eintritt, Austritt, Tod und Fortsetzung", "Beendigung und Liquidation der oHG", "Ablauf, Haftung, Nachschlusspflicht"]},
            {"id": "kg", "name": "ü§ù KG - Kommanditgesellschaft", "keywords": ["Begriff, Wesen und Rechtsnatur der KG", "Aufbau, Beteiligungs¬≠formen und Abgrenzung zur oHG", "Gr√ºndung einer KG", "Ablauf, Handelsregister, typische Fehler", "Gesellschaftsvertrag der KG", "Mindestanforderungen und Gestaltungs¬≠spielr√§ume", "Innenverh√§ltnis der KG", "Rechte, Pflichten und Kontrollmechanismen", "Au√üenverh√§ltnis und Vertretung", "wer handelt wie f√ºr die KG", "Haftung von Kommanditist:innen und Komplement√§r:innen", "Risiken", "Schutzmechanismen", "Beschlussfassung in der KG", "Stimmrechte, Sonderrechte, Vetoregeln", "Eintritt, Austritt und Nachfolge", "Gesellschafterwechsel in der KG", "Beendigung und Liquidation der KG", "Ablauf, Sonderfragen, Nachhaftung", "Die KG im Unternehmensverbund", "Holdingstrukturen, GmbH", "Co. KG, steuerliche Optimierung", "Die oHG im Konzern und Unternehmensverbund", "Kooperationsformen und Vertragskonstellationen"]},
            {"id": "gmbh_cokg", "name": "üè¢ GmbH & Co. KG", "keywords": ["Begriff, Struktur und Besonderheiten der GmbH", "Co. KG", "Trennung von Haftung", "F√ºhrung", "Gr√ºndung einer GmbH", "Co. KG", "Ablauf, Anforderungen und typische Fehlerquellen", "Gesellschaftsvertr√§ge in der GmbH", "Co. KG", "doppelte Vertragsstruktur rechtssicher gestalten", "Innenverh√§ltnis", "Zusammenspiel von GmbH, Kommanditist:innen und Gesch√§ftsf√ºhrung", "Haftungsstruktur in der GmbH", "Co. KG", "wer haftet wie wof√ºr", "Haftung von Kommanditist:innen und Komplement√§r:innen", "Risiken", "Schutzmechanismen", "Steuerliche Besonderheiten", "Mitunternehmerschaft, ¬ß 15 EStG, Verlustverrechnung", "Beteiligung von Familienmitgliedern", "Dritten", "Gesellschafterstrategie", "Verm√∂gensnachfolge", "Exit, Umwandlung", "Aufl√∂sung", "rechtssichere Beendigung der GmbH", "Co. KG", "Die GmbH", "Co. KG im Konzern", "Holdingstrukturen, Vertragsmodelle, Investoreneinstieg"]},
            {"id": "gmbh_beschraenkt", "name": "üíº GmbH - Gesellschaft mit beschr√§nkter...", "keywords": ["Begriff, Struktur und Rechtsnatur der GmbH", "Kapitalgesellschaft mit Personen¬≠element", "Gr√ºndung der GmbH", "Schritte, Kosten, Handelsregister", "Musterprotokoll", "Gesellschaftsvertrag der GmbH", "Pflichtbestandteile", "Gestaltungs¬≠spielr√§ume", "Disquotale Einzahlungen in die Kapitalr√ºcklage, F√∂rderung", "Finanzierung", "Gesellschaftsformstellung", "Gesch√§ftsf√ºhrung und Vertretung der GmbH", "Rechte, Pflichten", "Haftung", "Pflichten der Gesellschafter in der GmbH", "Kapital, Weisungen", "Treuepflicht", "Gesellschafterwechsel in der GmbH", "√úbertragung, Abtretung, Vinkulierung", "Einziehung", "Aufl√∂sung, Liquidation", "L√∂schung der GmbH", "Ablauf, Pflichten", "Nachhaftung", "Exit", "Umwandlung der GmbH", "Verschmelzung, Formwechsel", "Strukturwandel nach UmwG", "Die GmbH im Konzern", "Holdingstruktur, Organschaft", "Ergebnisabf√ºhrungsvertrag"]},
            {"id": "geschaeftsfuehrer", "name": "üëî GmbH Gesch√§ftsf√ºhrer", "keywords": ["Bestellung GF", "Voraussetzungen, Verfahren", "Praxishinweise", "Bestellung GF", "Besondere Bestellungsf√§lle", "Satzungsbestellung, Sonderrechte", "Bestellung GF", "Bestellung mehrerer Gesch√§ftsf√ºhrer:innen", "Vertretungsregelung, ¬ß 181 BGB Befreiung", "Vertretungsmacht GF", "Einzelvertretung, Gesamtvertretung", "Zeichnungsberechtigung", "Abberufung GF", "Rechtslage, Verfahren und Grenzen", "Abberufung GF - Trennung von Organstellung", "Anstellungsverh√§ltnis", "was endet wann", "Vertragsverh√§ltnis GF - Zustandekommen, Mindest¬≠inhalte", "Risiken ohne Vertrag", "Vertragsverh√§ltnis GF - Bei einer Konzern¬≠gesellschaft oder KG bei GmbH", "Co. KG", "Pflichten GF - Arbeitskraft", "Dienstort - Pr√§senzpflicht, Arbeitszeit", "Gesundheitspr√ºfung", "Pflichten GF - Nebent√§tigkeiten", "Pflichten GF - Verschwiegenheit und Vertraulichkeit w√§hrend und nach der T√§tigkeit"]},
            {"id": "ag", "name": "üìä AG - Aktiengesellschaft", "keywords": ["Begriff", "Wesen der Aktiengesellschaft", "Struktur, Abgrenzung", "Besonderheiten", "Gr√ºndung einer Aktiengesellschaft", "Voraussetzungen, Ablauf", "Besonderheiten", "Satzung", "Grundkapital der AG", "Anforderungen, Gestaltung", "Kapitalbindung", "Aktienarten", "√úbertragung", "Namensaktien, Inhaberaktien", "Vinkulierung in der AG", "Organe der AG", "Vorstand, Aufsichtsrat", "Hauptversammlung im √úberblick", "Bestellung", "Abberufung des Vorstands", "Verfahren, Voraussetzungen", "Mitbestimmung", "Rechte", "Pflichten des Vorstands", "Legalit√§tspflicht, Vertretung", "Haftung", "¬ß¬ß 93 AktG", "Aufgaben des Aufsichtsrats", "√úberwachung, Bestellung", "Berichtspflichten", "Hauptversammlung", "Ablauf, Beschlussfassung", "Rechte der Aktion√§re", "¬ß¬ß 118‚Äì147 AktG", "Kapitalma√ünahmen in der AG", "Kapitalerh√∂hung, -herabsetzung", "Bezugsrechte", "¬ß¬ß 182‚Äì240 AktG", "Investor Relations", "B√∂rseneinf√ºhrung", "Kommunikation, IPO", "Kapitalmarkt¬≠anforderungen", "Besonderheiten b√∂rsennotierter AGs", "Governance-Kodex", "Kapitalmarktrecht", "Beendigung", "Liquidation der AG", "Aufl√∂sung, Abwicklung", "L√∂schung", "¬ß¬ß 262‚Äì274 AktG"]},
            {"id": "transparenzregister", "name": "üìã Transparenzregister", "keywords": ["Eintragungspflicht pr√ºfen", "Wer muss ins Transparenz¬≠register", "Ermittlung wirtschaftlich Berechtigter", "Schritt f√ºr Schritt nach ¬ß 3 GwG", "Eintragungsverfahren", "Registermeldung bis zur Registermeldung", "¬ß 19 GwG", "Mehrstufige Beteiligungs¬≠ketten", "Wer gilt als wirtschaftlich Berechtigter", "Sonderf√§lle", "Stiftung, Trust, GbR", "Vereine im Transparenz¬≠register", "Registereintr√§ge aktualisieren", "Welche √Ñnderungen m√ºssen gemeldet werden", "Umsatzsteuerliche Korrekturen bei uneinbringlichen Forderungen", "¬ß17 UStG", "Ausl√§ndische Gesellschaft mit Immobilien¬≠eigentum in Deutschland", "Eintragungs¬≠pflicht", "Unstimmigkeits¬≠meldungen", "Bu√ügelder vermeiden", "Pflichten", "Praxistipps", "¬ß 23a, ¬ß 56 GwG", "Checkliste f√ºr Berater", "Wann besteht Handlungs¬≠bedarf im Transparenz¬≠register"]},
        ]
    }
}
    }

    // Map prompt to theme based on keywords
    getPromptTheme(prompt, role) {
        const roleThemes = this.themeMapping[role];
        if (!roleThemes) return null;

        for (const theme of roleThemes.themes) {
            for (const keyword of theme.keywords) {
                if (prompt.name.toLowerCase().includes(keyword.toLowerCase())) {
                    return theme.id;
                }
            }
        }
        
        // Fallback: return first theme
        return roleThemes.themes[0].id;
    }

    // Get prompts for a specific theme
    getPromptsForTheme(role, themeId) {
        return this.allPrompts.filter(p => {
            if (p.category !== role) return false;
            const promptTheme = this.getPromptTheme(p, role);
            return promptTheme === themeId;
        });
    }

    // Get theme statistics
    getThemeStats(role, themeId) {
        const prompts = this.getPromptsForTheme(role, themeId);
        return {
            total: prompts.length,
            fundamental: prompts.filter(p => p.tags?.includes('Fundamental')).length,
            erweitert: prompts.filter(p => p.tags?.includes('Erweitert')).length,
            premium: prompts.filter(p => p.tags?.includes('Premium')).length
        };
    }

    getRoleCount() {
        const roles = new Set(this.allPrompts.map(p => p.category));
        return roles.size;
    }

    init(context = null) {
        if (context) {
            this.addTaskFromCommandCenter(context);
        }
        this.renderMainView();
        console.log('‚úÖ Prompts Engine ready (3-Level)');
    }

    addTaskFromCommandCenter(context) {
        const task = {
            id: Date.now(),
            title: context.task,
            agent: this.getAgentName(context.agentId),
            agentId: context.agentId,
            matchScore: context.matchScore || 98,
            source: context.email ? 'email' : 'manual',
            email: context.email,
            attachments: context.attachments || [],
            timestamp: new Date().toISOString()
        };
        
        const exists = this.taskQueue.find(t => 
            t.title === task.title && t.agentId === task.agentId
        );
        
        if (!exists) {
            this.taskQueue.push(task);
            console.log('‚úÖ Task added to queue:', task);
        }
    }

    /* ========================================== */
    /* MAIN VIEW RENDERING */
    /* ========================================== */

    renderMainView() {
        const container = document.getElementById('prompts-content');
        if (!container) return;
        
        container.innerHTML = `
            <!-- Mode Switcher -->
            <div class="mode-switcher">
                <button 
                    class="mode-btn ${this.currentMode === 'templates' ? 'active' : ''}"
                    onclick="window.promptsEngine.switchMode('templates')"
                >
                    üìö Expert Templates
                </button>
                <button 
                    class="mode-btn ${this.currentMode === 'freeform' ? 'active' : ''}"
                    onclick="window.promptsEngine.switchMode('freeform')"
                >
                    üÜì Custom Builder
                </button>
            </div>
            
            ${this.currentMode === 'templates' ? this.renderTemplateMode() : this.renderFreeFormMode()}
        `;
        
        this.setupEventListeners();
    }

    switchMode(mode) {
        this.currentMode = mode;
        this.currentView = 'roles';
        this.currentRole = null;
        this.currentTheme = null;
        this.currentPrompt = null;
        this.renderMainView();
    }

    renderTemplateMode() {
        // Render based on current view
        if (this.currentView === 'roles') {
            return this.renderRolesView();
        } else if (this.currentView === 'themes') {
            return this.renderThemesView();
        } else if (this.currentView === 'prompts') {
            return this.renderPromptsView();
        }
    }

    /* ========================================== */
    /* LEVEL 1: ROLES VIEW */
    /* ========================================== */

    renderRolesView() {
        const roles = this.getRoles();
        
        return `
            <div class="prompts-template-section">
                <h2 class="section-title">üíº W√§hle deine Rolle</h2>
                <p class="section-subtitle">${this.allPrompts.length} Prompts in ${roles.length} Rollen verf√ºgbar</p>
                
                <div class="roles-grid">
                    ${roles.map(role => this.renderRoleCard(role)).join('')}
                </div>
            </div>
        `;
    }

    renderRoleCard(role) {
        const roleIcon = this.getRoleIcon(role.name);
        return `
            <div class="role-card" onclick="window.promptsEngine.selectRole('${role.name}')">
                <div class="role-icon">${roleIcon}</div>
                <div class="role-info">
                    <h3 class="role-name">${role.name}</h3>
                    <p class="role-count">${role.count} Prompts verf√ºgbar</p>
                </div>
                <div class="role-arrow">‚Üí</div>
            </div>
        `;
    }

    /* ========================================== */
    /* LEVEL 2: THEMES VIEW */
    /* ========================================== */

    renderThemesView() {
        const roleData = this.themeMapping[this.currentRole];
        if (!roleData) return '';

        const roleIcon = this.getRoleIcon(this.currentRole);
        const totalPrompts = this.allPrompts.filter(p => p.category === this.currentRole).length;

        return `
            <div class="prompts-template-section">
                <!-- Breadcrumb Navigation -->
                <div class="breadcrumb-nav">
                    <button onclick="window.promptsEngine.goBackToRoles()" class="breadcrumb-back">
                        ‚Üê Zur√ºck zu Rollen
                    </button>
                </div>

                <h2 class="section-title">${roleIcon} ${this.currentRole}</h2>
                <p class="section-subtitle">${totalPrompts} Prompts in ${roleData.themes.length} Hauptthemen</p>
                
                <div class="themes-grid">
                    ${roleData.themes.map(theme => this.renderThemeCard(theme)).join('')}
                </div>
            </div>
        `;
    }

    renderThemeCard(theme) {
        const stats = this.getThemeStats(this.currentRole, theme.id);
        
        return `
            <div class="theme-card" onclick="window.promptsEngine.selectTheme('${theme.id}')">
                <div class="theme-header">
                    <h3 class="theme-name">${theme.name}</h3>
                    <div class="theme-arrow">‚Üí</div>
                </div>
                <div class="theme-stats">
                    <span class="theme-count">${stats.total} Prompts</span>
                    ${stats.fundamental > 0 ? `<span class="badge badge-fundamental">${stats.fundamental} Fundamental</span>` : ''}
                    ${stats.erweitert > 0 ? `<span class="badge badge-erweitert">${stats.erweitert} Erweitert</span>` : ''}
                    ${stats.premium > 0 ? `<span class="badge badge-premium">${stats.premium} Premium</span>` : ''}
                </div>
            </div>
        `;
    }

    /* ========================================== */
    /* LEVEL 3: PROMPTS VIEW */
    /* ========================================== */

    renderPromptsView() {
        const prompts = this.getPromptsForTheme(this.currentRole, this.currentTheme);
        const roleData = this.themeMapping[this.currentRole];
        const theme = roleData.themes.find(t => t.id === this.currentTheme);
        
        if (!theme) return '';

        return `
            <div class="prompts-template-section">
                <!-- Breadcrumb Navigation -->
                <div class="breadcrumb-nav">
                    <button onclick="window.promptsEngine.goBackToThemes()" class="breadcrumb-back">
                        ‚Üê Zur√ºck zu ${this.currentRole}
                    </button>
                </div>

                <h2 class="section-title">${theme.name}</h2>
                <p class="section-subtitle">${prompts.length} Prompts verf√ºgbar</p>
                
                <!-- Prompt List -->
                <div class="prompt-list-simple">
                    ${prompts.map(prompt => this.renderPromptListItem(prompt)).join('')}
                </div>
            </div>
        `;
    }

    renderPromptListItem(prompt) {
        const impactClass = prompt.tags?.includes('Premium') ? 'premium' : 
                          prompt.tags?.includes('Erweitert') ? 'erweitert' : 'fundamental';
        
        return `
            <div class="prompt-list-item" onclick="window.promptsEngine.selectPrompt('${prompt.id}')">
                <div class="prompt-icon">${prompt.icon || 'üìÑ'}</div>
                <div class="prompt-details">
                    <h4 class="prompt-name">${prompt.name}</h4>
                    <div class="prompt-meta">
                        <span class="badge badge-${impactClass}">${prompt.tags?.[0] || 'Standard'}</span>
                        <span class="prompt-duration">‚è±Ô∏è ${prompt.duration || 30} Min</span>
                    </div>
                </div>
                <div class="prompt-arrow">‚Üí</div>
            </div>
        `;
    }

    /* ========================================== */
    /* NAVIGATION METHODS */
    /* ========================================== */

    selectRole(roleName) {
        this.currentRole = roleName;
        this.currentView = 'themes';
        this.currentTheme = null;
        this.currentPrompt = null;
        this.renderMainView();
    }

    selectTheme(themeId) {
        this.currentTheme = themeId;
        this.currentView = 'prompts';
        this.currentPrompt = null;
        this.renderMainView();
    }

    selectPrompt(promptId) {
        const prompt = this.allPrompts.find(p => p.id === promptId);
        if (!prompt) return;
        
        this.currentPrompt = prompt;
        this.renderPromptDetail(prompt);
    }

    goBackToRoles() {
        this.currentView = 'roles';
        this.currentRole = null;
        this.currentTheme = null;
        this.currentPrompt = null;
        this.renderMainView();
    }

    goBackToThemes() {
        this.currentView = 'themes';
        this.currentTheme = null;
        this.currentPrompt = null;
        this.renderMainView();
    }

    goBackToPrompts() {
        this.currentPrompt = null;
        this.renderMainView();
    }

    /* ========================================== */
    /* PROMPT DETAIL VIEW */
    /* ========================================== */

    renderPromptDetail(prompt) {
        const container = document.getElementById('prompts-content');
        if (!container) return;

        container.innerHTML = `
            <div class="prompt-detail-view">
                <!-- Breadcrumb -->
                <div class="breadcrumb-nav">
                    <button onclick="window.promptsEngine.goBackToPrompts()" class="breadcrumb-back">
                        ‚Üê Zur√ºck
                    </button>
                </div>

                <!-- Prompt Header -->
                <div class="prompt-detail-header">
                    <div class="prompt-icon-large">${prompt.icon || 'üìÑ'}</div>
                    <div>
                        <h2 class="prompt-detail-title">${prompt.name}</h2>
                        <p class="prompt-detail-meta">${prompt.category} ‚Ä¢ ‚è±Ô∏è ${prompt.duration || 30} Min</p>
                    </div>
                </div>

                <!-- Goal -->
                <div class="prompt-section">
                    <h3 class="prompt-section-title">üéØ Ziel</h3>
                    <p class="prompt-section-content">${prompt.goal || prompt.name}</p>
                </div>

                <!-- Full Prompt -->
                <div class="prompt-section">
                    <h3 class="prompt-section-title">üìã Vollst√§ndiger Prompt</h3>
                    <div class="prompt-code-box">
                        <button class="copy-btn" onclick="window.promptsEngine.copyPromptCode('${prompt.id}')">
                            üìã Kopieren
                        </button>
                        <pre class="prompt-code" id="prompt-code-${prompt.id}">${this.escapeHtml(prompt.fullPromptText || 'Kein Prompt-Text verf√ºgbar')}</pre>
                    </div>
                    <p class="prompt-transparency-note">üí° <strong>100% Transparenz:</strong> Das ist exakt der Prompt, der an die AI gesendet wird.</p>
                </div>

                <!-- Questions/Inputs -->
                ${prompt.questions && prompt.questions.length > 0 ? `
                <div class="prompt-section">
                    <h3 class="prompt-section-title">üîç Deine Eingaben</h3>
                    <div class="prompt-questions">
                        ${prompt.questions.map((q, idx) => `
                            <div class="question-group">
                                <label class="question-label">
                                    ${idx + 1}. ${q.question}
                                </label>
                                <input 
                                    type="text" 
                                    class="question-input"
                                    placeholder="${q.example || 'Ihre Antwort'}"
                                    id="answer-${prompt.id}-${idx}"
                                    onchange="window.promptsEngine.updateAnswer('${prompt.id}', ${idx}, this.value)"
                                />
                                <p class="question-example">üí° Beispiel: ${q.example}</p>
                            </div>
                        `).join('')}
                    </div>
                </div>
                ` : ''}

                <!-- Actions -->
                <div class="prompt-actions">
                    <button class="btn btn-primary" onclick="window.promptsEngine.executePrompt('${prompt.id}')">
                        ‚ñ∂Ô∏è Prompt ausf√ºhren
                    </button>
                    <button class="btn btn-secondary" onclick="window.promptsEngine.addToQueue('${prompt.id}')">
                        ‚ûï Zur Task Queue
                    </button>
                </div>
            </div>
        `;
    }

    updateAnswer(promptId, questionIndex, value) {
        if (!this.userAnswers[promptId]) {
            this.userAnswers[promptId] = {};
        }
        this.userAnswers[promptId][questionIndex] = value;
    }

    copyPromptCode(promptId) {
        const codeElement = document.getElementById(`prompt-code-${promptId}`);
        if (codeElement) {
            navigator.clipboard.writeText(codeElement.textContent);
            alert('‚úÖ Prompt kopiert!');
        }
    }

    executePrompt(promptId) {
        const prompt = this.allPrompts.find(p => p.id === promptId);
        if (!prompt) return;

        // Get user answers
        const answers = this.userAnswers[promptId] || {};
        
        console.log('üöÄ Executing prompt:', prompt.name);
        console.log('üìù User answers:', answers);
        
        // TODO: Integrate with AI execution
        alert(`‚úÖ Prompt "${prompt.name}" wird ausgef√ºhrt!\n\n(AI-Integration folgt)`);
    }

    addToQueue(promptId) {
        const prompt = this.allPrompts.find(p => p.id === promptId);
        if (!prompt) return;

        const task = {
            id: Date.now(),
            title: prompt.name,
            agent: prompt.role || prompt.category,
            agentId: prompt.id,
            matchScore: 100,
            source: 'manual',
            timestamp: new Date().toISOString()
        };

        this.taskQueue.push(task);
        console.log('‚úÖ Added to queue:', task);
        alert(`‚úÖ "${prompt.name}" zur Task Queue hinzugef√ºgt!`);
    }

    /* ========================================== */
    /* FREE-FORM MODE */
    /* ========================================== */

    renderFreeFormMode() {
        return `
            <div class="prompts-freeform-section">
                <h2 class="section-title">üÜì Custom Prompt Builder</h2>
                <p class="section-subtitle">Erstelle deinen eigenen Prompt</p>
                
                <div class="freeform-builder">
                    <div class="form-group">
                        <label>Rolle / Agent</label>
                        <select class="form-control" id="freeform-role">
                            <option>Controller</option>
                            <option>Treasury</option>
                            <option>CFO</option>
                            <option>M&A</option>
                            <option>Bilanzbuchhalter</option>
                            <option>Business Developer</option>
                            <option>Fachanwalt</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>Aufgabe / Ziel</label>
                        <textarea 
                            class="form-control" 
                            id="freeform-task" 
                            rows="3"
                            placeholder="Was m√∂chtest du erreichen?"
                        ></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label>Context / Details</label>
                        <textarea 
                            class="form-control" 
                            id="freeform-context" 
                            rows="5"
                            placeholder="Gib relevante Details und Kontext..."
                        ></textarea>
                    </div>
                    
                    <button class="btn btn-primary" onclick="window.promptsEngine.executeFreeForm()">
                        ‚ñ∂Ô∏è Prompt ausf√ºhren
                    </button>
                </div>
            </div>
        `;
    }

    executeFreeForm() {
        const role = document.getElementById('freeform-role')?.value;
        const task = document.getElementById('freeform-task')?.value;
        const context = document.getElementById('freeform-context')?.value;

        if (!task) {
            alert('‚ö†Ô∏è Bitte gib eine Aufgabe ein');
            return;
        }

        console.log('üöÄ Executing custom prompt:', { role, task, context });
        alert(`‚úÖ Custom Prompt wird ausgef√ºhrt!\n\n(AI-Integration folgt)`);
    }

    /* ========================================== */
    /* HELPER METHODS */
    /* ========================================== */

    getRoles() {
        const roleMap = new Map();
        
        this.allPrompts.forEach(prompt => {
            const role = prompt.category;
            if (!roleMap.has(role)) {
                roleMap.set(role, { name: role, count: 0 });
            }
            roleMap.get(role).count++;
        });
        
        return Array.from(roleMap.values()).sort((a, b) => b.count - a.count);
    }

    getRoleIcon(role) {
        const icons = {
            'Controller': 'üìä',
            'Treasury': 'üè¶',
            'Tax': 'üí∞',
            'CFO': 'üìà',
            'M&A': 'ü§ù',
            'Bilanzbuchhalter': 'üìö',
            'Business Developer': 'üöÄ',
            'Fachanwalt Gesellschaftsrecht': '‚öñÔ∏è',
            'Accountant': 'üíº',
            'Finance Manager': 'üíµ',
            'Auditor': 'üîç'
        };
        return icons[role] || 'üíº';
    }

    getAgentName(agentId) {
        const agents = {
            'controller': 'Controller',
            'treasury': 'Treasury Manager',
            'cfo': 'CFO',
            'ma': 'M&A Specialist',
            'accountant': 'Bilanzbuchhalter'
        };
        return agents[agentId] || 'Finance Expert';
    }

    escapeHtml(text) {
        const div = document.createElement('div');
        div.textContent = text;
        return div.innerHTML;
    }

    setupEventListeners() {
        // Event listeners k√∂nnen hier hinzugef√ºgt werden
    }

    /* ========================================== */
    /* DATA LOADING */
    /* ========================================== */

    getAllPrompts() {
        const builtinPrompts = [];

        // Load Controller Prompts
        const controllerPrompts = (typeof NOTION_PROMPTS !== 'undefined' && Array.isArray(NOTION_PROMPTS)) 
            ? NOTION_PROMPTS 
            : [];

        // Load Treasury Prompts
        const treasuryPrompts = (typeof TREASURY_PROMPTS !== 'undefined' && Array.isArray(TREASURY_PROMPTS)) 
            ? TREASURY_PROMPTS 
            : [];

        // Load CFO Prompts
        const cfoPrompts = (typeof CFO_PROMPTS !== 'undefined' && Array.isArray(CFO_PROMPTS)) 
            ? CFO_PROMPTS 
            : [];

        // Load M&A Prompts
        const maPrompts = (typeof MA_PROMPTS !== 'undefined' && Array.isArray(MA_PROMPTS)) 
            ? MA_PROMPTS 
            : [];

        // Load Bilanzbuchhalter Prompts
        const bilanzPrompts = (typeof BILANZ_PROMPTS !== 'undefined' && Array.isArray(BILANZ_PROMPTS)) 
            ? BILANZ_PROMPTS 
            : [];

        // Load Business Developer Prompts
        const bizdevPrompts = (typeof BIZDEV_PROMPTS !== 'undefined' && Array.isArray(BIZDEV_PROMPTS)) 
            ? BIZDEV_PROMPTS 
            : [];

        // Load Fachanwalt Prompts
        const lawyerPrompts = (typeof LAWYER_PROMPTS !== 'undefined' && Array.isArray(LAWYER_PROMPTS)) 
            ? LAWYER_PROMPTS 
            : [];

        console.log(`üì¶ Loaded ${controllerPrompts.length} Controller prompts`);
        console.log(`üè¶ Loaded ${treasuryPrompts.length} Treasury prompts`);
        console.log(`üìà Loaded ${cfoPrompts.length} CFO prompts`);
        console.log(`ü§ù Loaded ${maPrompts.length} M&A prompts`);
        console.log(`üìö Loaded ${bilanzPrompts.length} Bilanzbuchhalter prompts`);
        console.log(`üöÄ Loaded ${bizdevPrompts.length} Business Developer prompts`);
        console.log(`‚öñÔ∏è Loaded ${lawyerPrompts.length} Fachanwalt prompts`);

        return [...builtinPrompts, ...controllerPrompts, ...treasuryPrompts, ...cfoPrompts, ...maPrompts, ...bilanzPrompts, ...bizdevPrompts, ...lawyerPrompts];
    }
}

// Initialize when DOM is ready
if (typeof window !== 'undefined') {
    window.PromptsEngine = PromptsEngine;
    console.log('‚úÖ PromptsEngine (3-Level) class loaded');
    
    // Global init function for navigation
    window.initPromptsTab = function() {
        console.log('üéØ initPromptsTab() called');
        
        if (!window.promptsEngine) {
            console.log('üì¶ Creating new PromptsEngine instance...');
            window.promptsEngine = new PromptsEngine();
        }
        
        window.promptsEngine.init();
        console.log('‚úÖ Prompts Engine initialized and rendered');
    };
    
    // Auto-initialize when prompts container exists
    document.addEventListener('DOMContentLoaded', function() {
        const promptsContainer = document.getElementById('prompts-content');
        if (promptsContainer) {
            console.log('üéØ Auto-initializing Prompts Engine (DOMContentLoaded)...');
            window.initPromptsTab();
        }
    });
    
    // Also check after a short delay (for dynamic content loading)
    setTimeout(function() {
        if (!window.promptsEngine) {
            const promptsContainer = document.getElementById('prompts-content');
            if (promptsContainer) {
                console.log('üéØ Auto-initializing Prompts Engine (delayed)...');
                window.initPromptsTab();
            }
        }
    }, 500);
}
